<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Blog of 太极儒]]></title>
  <link href="http://frank19900731.github.io/feed" rel="self"/>
  <link href="http://frank19900731.github.io/"/>
  <updated>2015-04-11T14:26:35+08:00</updated>
  <id>http://frank19900731.github.io/</id>
  <author>
    <name><![CDATA[Frank Song]]></name>
    <email><![CDATA[scr_0731@126.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[每周一软之 Paste]]></title>
    <link href="http://frank19900731.github.io/blog/2015/04/11/mei-zhou-yi-ruan-zhi-paste/"/>
    <updated>2015-04-11T14:07:26+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/04/11/mei-zhou-yi-ruan-zhi-paste</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<p>毕业季，论文施工中，有空再补。。。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/1.gif" class="img-up" title="论文施工中"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-3/1.gif" width="40%" title="论文施工中" /></a></p>

<!-- excerpt end -->

<h2 id="section">功能介绍</h2>

<h2 id="section-1">界面设计</h2>

<h2 id="section-2">易用性</h2>

<h2 id="section-3">稳定性</h2>

<h2 id="section-4">跨平台</h2>

<h2 id="section-5">类似软件</h2>

<h2 id="section-6">闪光点</h2>

<h2 id="section-7">缺点</h2>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/04/11/mei-zhou-yi-ruan-zhi-paste/">http://frank19900731.github.io/blog/2015/04/11/mei-zhou-yi-ruan-zhi-paste/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 TexPad]]></title>
    <link href="http://frank19900731.github.io/blog/2015/04/07/mei-zhou-yi-ruan-zhi-texpad/"/>
    <updated>2015-04-07T13:12:18+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/04/07/mei-zhou-yi-ruan-zhi-texpad</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<p>毕业季，论文施工中，有空再补。。。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/1.gif" class="img-up" title="论文施工中"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-3/1.gif" width="40%" title="论文施工中" /></a></p>

<!-- excerpt end -->

<h2 id="section">功能介绍</h2>

<h2 id="section-1">界面设计</h2>

<h2 id="section-2">易用性</h2>

<h2 id="section-3">稳定性</h2>

<h2 id="section-4">跨平台</h2>

<h2 id="section-5">类似软件</h2>

<h2 id="section-6">闪光点</h2>

<h2 id="section-7">缺点</h2>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/04/07/mei-zhou-yi-ruan-zhi-texpad/">http://frank19900731.github.io/blog/2015/04/07/mei-zhou-yi-ruan-zhi-texpad/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 GeekTool]]></title>
    <link href="http://frank19900731.github.io/blog/2015/03/30/mei-zhou-yi-ruan-zhi-geektool/"/>
    <updated>2015-03-30T19:48:49+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/03/30/mei-zhou-yi-ruan-zhi-geektool</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<p>毕业季，论文施工中，有空再补。。。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/1.gif" class="img-up" title="论文施工中"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-3/1.gif" width="40%" title="论文施工中" /></a></p>

<!-- excerpt end -->

<h2 id="section">功能介绍</h2>

<h2 id="section-1">界面设计</h2>

<h2 id="section-2">易用性</h2>

<h2 id="section-3">稳定性</h2>

<h2 id="section-4">跨平台</h2>

<h2 id="section-5">类似软件</h2>

<h2 id="section-6">闪光点</h2>

<h2 id="section-7">缺点</h2>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/03/30/mei-zhou-yi-ruan-zhi-geektool/">http://frank19900731.github.io/blog/2015/03/30/mei-zhou-yi-ruan-zhi-geektool/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 Curio]]></title>
    <link href="http://frank19900731.github.io/blog/2015/03/23/mei-zhou-yi-ruan-zhi-curio/"/>
    <updated>2015-03-23T00:36:42+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/03/23/mei-zhou-yi-ruan-zhi-curio</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<p>毕业季，论文施工中，有空再补。。。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/1.gif" class="img-up" title="论文施工中"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-3/1.gif" width="40%" title="论文施工中" /></a></p>

<!-- excerpt end -->

<h2 id="section">功能介绍</h2>

<h2 id="section-1">界面设计</h2>

<h2 id="section-2">易用性</h2>

<h2 id="section-3">稳定性</h2>

<h2 id="section-4">跨平台</h2>

<h2 id="section-5">类似软件</h2>

<h2 id="section-6">闪光点</h2>

<h2 id="section-7">缺点</h2>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/03/23/mei-zhou-yi-ruan-zhi-curio/">http://frank19900731.github.io/blog/2015/03/23/mei-zhou-yi-ruan-zhi-curio/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 Soulver]]></title>
    <link href="http://frank19900731.github.io/blog/2015/03/15/mei-zhou-yi-ruan-zhi-soulver/"/>
    <updated>2015-03-15T18:21:49+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/03/15/mei-zhou-yi-ruan-zhi-soulver</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a>    <ul>
      <li><a href="#section-6">普通计算器</a></li>
      <li><a href="#section-7">交互式编程环境</a></li>
    </ul>
  </li>
  <li><a href="#section-8">闪光点</a></li>
  <li><a href="#section-9">缺点</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">功能介绍</h2>

<p><a href="http://www.acqualia.com/soulver/">Soulver</a> 是一款智能计算器，允许<strong>计算公式与文档混排</strong>，提供汇率与股价的查询计算、变量定义、结果引用、版本保存、简单统计等功能。</p>

<p>下面先以软件自带样例文件具体介绍其功能。</p>

<p>Soulver 使用文档保存计算过程，文档格式为 XML，可导出 PDF 文件。</p>

<p>这幅图显示了文档块定义（比如 Simple Math 粗体）、简单计算、以语义表示的计算、注释以及汇率转换、单位转换的用法。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/13.png" class="img-up" title="Soulver 使用样例一"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/13.png" width="100%" title="Soulver 使用样例一" /></a></p>

<!-- excerpt end -->

<p>这幅图显示了结果引用、变量、股票价格、函数的用法。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/14.png" class="img-up" title="Soulver 使用样例二"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/14.png" width="100%" title="Soulver 使用样例二" /></a></p>

<p>结果引用、汇率、股票价格都是<strong>依赖某一个数值</strong>，当依赖值改变，使用此依赖值的计算结果也会随之变化。我们需要做的仅是列写公式，更新依赖值。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/15.png" class="img-up" title="汇率值、股票价格更新"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/15.png" width="90%" title="汇率值、股票价格更新" /></a></p>

<p>上图 Variables 窗格中可以定义<strong>全局变量</strong>，对每个计算文档生效。</p>

<p>可以在设置中修改支持中文输入，如下图所示。计算时可以切换弧度制、角度制，设置小数点保留精度。点击 Answer Palette 可以看到结果的其它表示形式，角度、分数、十进制、二进制、十六进制等。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/16.png" class="img-up" title="Soulver 使用样例三"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/16.png" width="100%" title="Soulver 使用样例三" /></a></p>

<p>Soulver 所支持的函数列表、逻辑计算、单位换算表等详见 Reference。</p>

<h2 id="section-1">界面设计</h2>

<p>界面设计美观，自定义方便。</p>

<h2 id="section-2">易用性</h2>

<p>容易使用，参考 Reference 即可。</p>

<h2 id="section-3">稳定性</h2>

<p>稳定性好，有一个瑕疵见 <a href="#section-8">缺点</a> 第三条。</p>

<h2 id="section-4">跨平台</h2>

<p>提供 iOS 版本。</p>

<h2 id="section-5">类似软件</h2>

<h3 id="section-6">普通计算器</h3>

<ul>
  <li>Mac 自带计算器，可放置于边栏；</li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/19.png" class="img-up" title="Mac 自带计算器"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-3/19.png" width="40%" title="Mac 自带计算器" /></a></p>

<ul>
  <li>
    <p><a href="https://itunes.apple.com/cn/app/numeric/id564960788?mt=12">Numeric</a> 特点是将输入区域映射到触摸板上，不必移动鼠标点击；</p>
  </li>
  <li>
    <p><a href="https://itunes.apple.com/us/app/addism-the-calculator/id943947757?mt=12">Addism</a> 可进行简单的科学计算，可以保存、分享结果；</p>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/18.png" class="img-up" title="Addism 界面"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/18.png" width="80%" title="Addism 界面" /></a></p>

<ul>
  <li><a href="http://getnumi.info/">Numi</a> 运行于菜单栏，和 Soulver 类似，也支持以语义定义简单计算。</li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/17.png" class="img-up" title="Numi 界面"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/17.png" width="70%" title="Numi 界面" /></a></p>

<h3 id="section-7">交互式编程环境</h3>

<p>对于理工科同学来说，以上计算功能还是不够的，一般会采用专门软件或编程语言，比如 Matlab、Mathematica、R、C、Python 等。<strong>联系 Soulver 文档与计算混排的特点</strong>，在相似软件中我推荐 <a href="http://yihui.name/knitr/">knitr</a> 和 <a href="http://ipython.org/notebook.html">iPython notebook</a>，可分别配合 R 与 Python 使用，<strong>用于生成图文数据详实的报告</strong>。此外，RStudio 提供了 <a href="http://www.rstudio.com/products/rstudio/download-server/">RStudio Server</a>，可以架设在个人服务器上提供网络访问，应付普通计算任务绰绰有余。</p>

<h2 id="section-8">闪光点</h2>

<ul>
  <li>计算公式与文档混排，方便阅读、理解；</li>
  <li>单位转换、汇率、股价等功能实用。</li>
</ul>

<h2 id="section-9">缺点</h2>

<ul>
  <li>函数库仍需扩展，min、max 函数竟都没有；</li>
  <li>无法进行条件判断，功能受限；</li>
  <li>文档中有大数字计算时，输入会异常卡顿，推测软件隔段时间计算文档每一行的结果，即便该行及该行的依赖未改变，应当予以优化。</li>
</ul>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/03/15/mei-zhou-yi-ruan-zhi-soulver/">http://frank19900731.github.io/blog/2015/03/15/mei-zhou-yi-ruan-zhi-soulver/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 FocusMask]]></title>
    <link href="http://frank19900731.github.io/blog/2015/03/08/mei-zhou-yi-ruan-zhi-focusmask/"/>
    <updated>2015-03-08T20:39:54+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/03/08/mei-zhou-yi-ruan-zhi-focusmask</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">功能介绍</h2>

<p><a href="http://tentrip.net/focusmask/">FocusMask</a> 是一款效率软件，通过在屏幕上隔离出某一区域（其它区域被遮罩），使用户专注于某项工作，比如隔离出编辑环境以专注写作。</p>

<p>FocusMask 虽然只是一招鲜，但个人觉得它提供的<strong>遮罩功能</strong>在日常工作学习中还是很实用的。类似于截图，FocusMask 的遮罩区域可以是框定的，也可以是当前窗口或视图，均可由快捷键触发。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/10.png" class="img-up" title="FocusMask 设置"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/10.png" width="80%" title="FocusMask 设置" /></a></p>

<!-- excerpt end -->

<p>以 Byword 写作为例，选定工作区域，之外的区域被遮罩。可以<strong>调整遮罩层的透明度</strong>，设定<strong>是否允许在工作区域外点击鼠标</strong>。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/11.png" class="img-up" title="区域框定"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-3/11.png" width="90%" title="区域框定" /></a></p>

<p><a href="http://frank19900731.github.io/img/post/2015-3/12.png" class="img-up" title="运行效果"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-3/12.png" width="90%" title="运行效果" /></a></p>

<p>如此，菜单栏、Docker 以及通知栏均不可见，可以在编辑区域安心工作了……</p>

<h2 id="section-1">界面设计</h2>

<p>界面设计简陋。</p>

<h2 id="section-2">易用性</h2>

<p>易于使用。</p>

<h2 id="section-3">稳定性</h2>

<p>稳定性好。</p>

<h2 id="section-4">跨平台</h2>

<p>无。</p>

<h2 id="section-5">类似软件</h2>

<p>迫使用户专注的一般做法是<code>屏蔽</code>。</p>

<p><code>视觉屏蔽</code>，比如 FocusMask，又比如 <a href="http://willmore.eu/software/isolator/">Isolator</a>，后者将工作区域设置为处于输入焦点的软件，之外的区域同样是遮罩。Isolator 相比 FocusMask 为遮罩提供了更多选项，可以设置颜色，也可以设置滤镜，不过滤镜功能在 OS X 10.8 及以上的系统中已无法使用。</p>

<p><code>听觉屏蔽</code>，推荐 <a href="https://coffitivity.com/">Coffitivity</a>，播放咖啡馆白噪音，网页版、PC 客户端、移动版均有提供。</p>

<p>比<code>视觉屏蔽</code>、<code>听觉屏蔽</code>更彻底的是<code>接触屏蔽</code>，比如禁止浏览器对某些网址的访问，禁止某时段某些软件的开启。</p>

<ul>
  <li>命令行工具
    <ul>
      <li><a href="https://github.com/amoffat/focus">Focus</a>，Python 编写，可屏蔽网址；</li>
      <li><a href="https://github.com/xtrementl/focus">Focus</a>，Python 编写，是一款强大的<strong>任务管理工具</strong>，除了可以屏蔽网址、软件，还可以给任务关联需要开启的软件、需要运行的脚本，也可以记录工作时间，生成简单的报告，称得上是极客工具；</li>
    </ul>
  </li>
  <li>图形界面工具
    <ul>
      <li><a href="http://selfcontrolapp.com/">SelfControl</a> ，<a href="https://github.com/SelfControlApp/selfcontrol">开源软件</a>，可屏蔽网址；</li>
      <li><a href="http://www.publicspace.net/Vitamin-R/">Vitamin-R</a>，大体是一款番茄工作法工具，可记录工作历史并生成图表，可于工作时段屏蔽指定软件，也可播放咖啡馆白噪音；</li>
      <li><a href="https://heyfocus.com/">Focus</a> ，屏蔽指定网址、软件，也可以在命令行操作，曾是 <a href="https://github.com/bradjasper/Focus">开源软件</a>。</li>
    </ul>
  </li>
</ul>

<h2 id="section-6">闪光点</h2>

<ul>
  <li>工作区域选择方式多样；</li>
  <li>可以屏蔽工作区域外的鼠标点击。</li>
</ul>

<h2 id="section-7">缺点</h2>

<p>遮罩区域样式单一，应允许自定义背景。</p>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/03/08/mei-zhou-yi-ruan-zhi-focusmask/">http://frank19900731.github.io/blog/2015/03/08/mei-zhou-yi-ruan-zhi-focusmask/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 Smart Scroll]]></title>
    <link href="http://frank19900731.github.io/blog/2015/03/01/mei-zhou-yi-ruan-zhi-smart-scroll/"/>
    <updated>2015-03-01T12:32:51+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/03/01/mei-zhou-yi-ruan-zhi-smart-scroll</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">功能介绍</h2>

<p><a href="http://www.marcmoini.com/sx_en.html">Smart Scroll</a> 一款<strong>鼠标/触摸板辅助软件</strong>，为滚轮或面板的滚动操作添加智能因素，显示于 System Preferences 面板中。</p>

<p>Smart Scroll 主要有六大功能，与其界面设计相对应。</p>

<ul>
  <li>Scroll Wheel（鼠标设备） 设置
    <ul>
      <li>调节滚动的速度、方向（Reverse）、距离（Range for a single tick）与惯性（Inertia+）；</li>
      <li>测试表明，<strong>在不同速度设置下</strong>，<strong>均可以实现平滑滚动</strong>；</li>
      <li>Multi-Touch（触摸设备）中的功能设置同 Scroll Wheel。</li>
    </ul>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/1.png" class="img-up" title="Scroll Wheel+"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/1.png" width="80%" title="Scroll Wheel+" /></a></p>

<!-- excerpt end -->

<ul>
  <li>Hover Scroll
    <ul>
      <li>可以设置窗口上下各一定区域，使得鼠标指针在该区域悬停时，窗口自动向上或向下滚动，速度可调整；</li>
      <li>鼠标指针越接近窗口上/下部，窗口向上/下滚动的速度越快（<strong>可能引发视觉抖动</strong>）；</li>
      <li>测试表明，鼠标指针需要<strong>以慢速进入设定区域</strong>，过快则无法触发 Hover Scroll。</li>
    </ul>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/3.png" class="img-up" title="Hover Scroll"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/3.png" width="80%" title="Hover Scroll" /></a></p>

<ul>
  <li>Auto Scroll
    <ul>
      <li>基于 Hover Scroll，以快捷键触发，鼠标指针被自动移到窗口下部，触发向下滚动操作。</li>
    </ul>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/4.png" class="img-up" title="Auto Scroll"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/4.png" width="80%" title="Auto Scroll" /></a></p>

<ul>
  <li>Grab Scroll
    <ul>
      <li>仅支持鼠标，拖拽页面滚动，类似于 <strong>PDF 阅读器中的手形图标拖动效果</strong>；</li>
      <li>同样可以调节速度、方向与惯性；</li>
      <li>Grab Scroll 可以采用快捷键+鼠标键的方式触发，以下图 <code>Option + Command + Secondary Button</code> 这一组合为例，需要先按下 Option 并<strong>保持</strong>，然后点击 Command（<strong>需抬起</strong>），之后按下鼠标右键方可拖动……</li>
    </ul>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/5.png" class="img-up" title="Grab Scroll"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/5.png" width="80%" title="Grab Scroll" /></a></p>

<ul>
  <li>Scroll Keys
    <ul>
      <li>滚动的快捷键操作，上下左右类似于箭头方向键；</li>
      <li>测试表明，快捷键滚动比箭头方向键滚动<strong>步长更细</strong>，<strong>也更平滑</strong>；</li>
    </ul>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/6.png" class="img-up" title="Scroll Keys"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/6.png" width="80%" title="Scroll Keys" /></a></p>

<ul>
  <li>Vector Scroll
    <ul>
      <li>仅支持鼠标，鼠标键的点击释放构成向量，向量方向确定滚动方向，向量的模确定滚动速度；</li>
      <li>如果设置 Secondary Button 触发，则右键菜单无法弹出，只能通过 Ctrl + Primary Button（鼠标左键） 查看。</li>
    </ul>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/7.png" class="img-up" title="Vector Scroll"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/7.png" width="80%" title="Vector Scroll" /></a></p>

<h2 id="section-1">界面设计</h2>

<p>界面设计较美观。</p>

<h2 id="section-2">易用性</h2>

<p>用法简单，只是初始需要设置适合自己使用习惯的参数。</p>

<h2 id="section-3">稳定性</h2>

<p>稳定性好。</p>

<h2 id="section-4">跨平台</h2>

<p>无。</p>

<h2 id="section-5">类似软件</h2>

<p>作为鼠标/触摸板辅助软件中的一款，Smart Scroll 专注于<strong>滚动的定制优化</strong>，而实际上这些设备有待发掘的远不止于此，以下两款软件可以提供更加丰富实用的定制功能。</p>

<ul>
  <li><a href="http://www.jitouch.com/">Jitouch</a> 也是安装后位于 System Preferences 中的一款软件，支持鼠标/触摸板手势、字符笔画识别，并可<strong>关联动作/快捷键</strong>。</li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/8.png" class="img-up" title="Jitouch"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/8.png" width="80%" title="Jitouch" /></a></p>

<ul>
  <li><a href="http://www.boastr.de/">Better Touch Tool</a> 是一款功能更加强大的辅助工具，几乎涵盖了 Smart Scroll、Jitouch 的所有功能，可定制项很多，有一种<strong>视觉压迫感</strong>，一看就是给 Geek 用的……
    <ul>
      <li>支持鼠标、触摸板、键盘快捷键、Apple Remote、Better Touch Tool 移动端（iOS）等的辅助功能定制；</li>
      <li>手势、动作远较 Jitouch 丰富，也正因为多，<strong>一些手势的识别准确性会降低</strong>，<strong>定制项目多也更容易引发误操作</strong>。</li>
    </ul>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-3/9.png" class="img-up" title="Better Touch Tool"><img class="imgcenter-no-shadow" src="http://frank19900731.github.io/img/post/2015-3/9.png" width="80%" title="Better Touch Tool" /></a></p>

<h2 id="section-6">闪光点</h2>

<ul>
  <li>滚动速度可调，且效果平滑，Hover Scroll 与 Scroll Keys 也能做到平滑滚动。</li>
</ul>

<h2 id="section-7">缺点</h2>

<ul>
  <li>Grab Scroll、Vector Scroll 只能配合鼠标使用，对于只用触摸板的用户就鸡肋了，但这些功能完全可以配合触摸板使用（严格说 Vector Scroll 已经可以配合触摸板使用，但只能使用 Secondary Button 触发，而之前我们提到这会影响右键菜单的查看）；</li>
  <li>Hover Scroll 速度快时有轻微抖动（当然，<strong>也很可能是我显卡差</strong>）。</li>
</ul>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/03/01/mei-zhou-yi-ruan-zhi-smart-scroll/">http://frank19900731.github.io/blog/2015/03/01/mei-zhou-yi-ruan-zhi-smart-scroll/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[返校途中关于学生票的小插曲]]></title>
    <link href="http://frank19900731.github.io/blog/2015/02/27/fan-xiao-tu-zhong-guan-yu-xue-sheng-piao-de-xiao-cha-qu/"/>
    <updated>2015-02-27T12:57:30+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/02/27/fan-xiao-tu-zhong-guan-yu-xue-sheng-piao-de-xiao-cha-qu</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">起因</a></li>
  <li><a href="#section-1">思考</a></li>
  <li><a href="#section-2">总结</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">起因</h2>

<p>春运期间往返北京、大连，购买了两张高铁学生票，而这也成了麻烦的开始。</p>

<p>日常出行大多不是此优惠区间段，再加上订票已近两月，所以我习惯性地只是携带了学校的 IC 卡，而非<strong>带有优惠磁条的学生证</strong>。等到想要在自动取票机取出车票的时候，才发现学生证未带，遭遇取票不能的尴尬。</p>

<p>北京南站的服务台的一位工作人员帮我把票取出，并“严厉”叮嘱我上车补票，又说<strong>从大连站回来也要经此流程</strong>。我虚心接受她的批评，感谢她的帮助，因为最根本的还是自己的疏忽。在高铁上，我主动联系列车员补足票款。</p>

<p>节后，当我以为可以按照这样的流程从大连回京时，却被车站人员告知无法取票，只能<strong>退票后再买</strong>，此时距离发车时间已不足两小时。在这样一个春运回程高峰时段，连<strong>省内（如沈阳）、河北、天津的车票都早已售罄</strong>，我又怎么可能退票后再买到回北京车票呢。</p>

<p>几番央求不过，只能拨打沈阳铁路局 12306 得到的是同样的答复，并被告知，<strong>在北京南站帮助我的工作人员是违规操作</strong>。无奈，我只得退票，一方面是个人减少点损失，另一方面也不占用这宝贵的车票资源。之后尝试把这张票刷回，可想而知是徒劳无功的。最后，改乘飞机总算是在当天返回北京。</p>

<p>事后，我反复琢磨车站<strong>要求退票而不能补票</strong>的原因。限于能力，我实在想不出退票比补票更高明的地方。这当中究竟如何更好地弥补了制度漏洞、<strong>保障了铁路系统和购票乘车人员的权利</strong>呢？我不得而知，反而生发了一连串的疑问。带着这样的疑问，我连续拨打了 12306 的电话咨询，虽然话务员帮我厘清了一些疑难，但也无法解释规定背后的考虑与用意，把截至目前的问答结果记录如下。</p>

<!-- excerpt end -->

<h2 id="section-1">思考</h2>

<ul>
  <li><strong>学生未带学生证需要退票重新购买 这一规定的出处在哪里？</strong></li>
</ul>

<p><a href="http://www.12306.cn/mormhweb/kygfwj/flgz/201001/t20100123_1208.html">《铁路旅客运输规程》</a>中规定</p>

<blockquote>
  <p>下列情况不能发售学生票：</p>

  <p>1．学校所在地有学生父或母其中一方时；</p>

  <p>2．学生因休学、复学、转学、退学时；</p>

  <p>3．学生往返于学校与实习地点时；</p>

  <p>4．学生证未按时办理学校注册的；</p>

  <p>5．学生证优惠乘车区间更改但未加盖学校公章的；</p>

  <p>6．没有“学生火车票优惠卡”、“学生火车票优惠卡”不能识别或者与学生证记载不一致的。</p>
</blockquote>

<p>我的情况属于第六条。</p>

<p>所谓<strong>退票重新购买</strong>并未明文写在《规程》中，而是这一规定的一个自然推论。既然没法取票，那按照人之常情，只能先退了，再买一张。</p>

<ul>
  <li><strong>接第二十条，发售意为出售，我在网上已然和铁路部门达成了学生票购票交易，如何解释？</strong></li>
</ul>

<p>网上购买时，<strong>没有相关手段进行学生证认证</strong>，<strong>凭购票人自觉自检</strong>。</p>

<p>愚见是，既然无法验证学生证，而铁路系统的工作人员又是这么认真的贯彻执行《规程》，那么在网上售卖学生票是不是有些违规？<strong>持学生证到火车站或指定代售点购买学生票</strong>才是唯一合规的购买方式吧。</p>

<p>此外，《规程》第四十四条规定</p>

<blockquote>
  <p>有下列行为时，除按规定补票，核收手续费以外，铁路运输企业有权对其身份进行登记，并须加收已乘区间应补票价50％的票款：</p>

  <p>1．无票乘车时，补收自乘车站（不能判明时自始发站）起至到站止车票票价。持失效车票乘车按无票处理。</p>

  <p>2．持用伪造或涂改的车票乘车时，除按无票处理外并送交公安部门处理。</p>

  <p>3．持站台票上车并在开车20分钟后仍不声明时，按无票处理。</p>

  <p>4．持用低等级的车票乘坐高等级列车、铺位、座席时，补收所乘区间的票价差额。</p>

  <p>5．旅客持儿童票、学生票、残疾军人票没有规定的减价凭证或不符合减价条件时，按照全价票价补收票价差额。</p>
</blockquote>

<p>根据这条规定的第5点，虽然我在网上付款购得学生票一张，但因为我<strong>不持有车票实体</strong>（隐约记得一些车站可以刷身份证进入，不需要报销的话就不用取出车票实体），所以无法将学生票补成全价票。即便我持有这张票也还是不代表我持有的是学生票，那<strong>铁道部门是如何认定以学生身份购买学生票的呢</strong>？</p>

<ul>
  <li>网上购买学生票
    <ul>
      <li><strong>不能确认</strong>，是个人就能在网上买学生票。</li>
    </ul>
  </li>
  <li>凭学生证到火车站或代售点购票，出票成功
    <ul>
      <li><strong>不能确认</strong>，因为上车时还要再次检查学生证，如果未带学生证需补票。</li>
    </ul>
  </li>
  <li>拿着学生票上车且出示学生证
    <ul>
      <li><strong>可以确认</strong>。</li>
    </ul>
  </li>
</ul>

<p>问题又来了，是列车员具有火眼金睛还是别的什么，让最后一个步骤得以一锤定音呢？此外，与身边同学的交谈中得知，在一些乘车经历中，他们并未被列车员要求出示学生证。</p>

<ul>
  <li><strong>小孩子买半票，但实际身高测量显示需要买全票，此时为什么可以补票而非退票再买？</strong></li>
</ul>

<p>《规程》第四十五条规定</p>

<blockquote>
  <p>第四十五条　有下列情况时补收票价，核收手续费：</p>

  <p>1．应买票而未买票的儿童按第十九条规定补收票价。身高超过1.5米的儿童使用儿童票乘车时，应补收儿童票价与全价票价的差额。</p>

  <p>….</p>
</blockquote>

<p>在咨询这一问题的时候，一位话务员的解答中还包含了一个概念错误——他说儿童票非实名制。我询问了身边的孩子家长，他们表示还是需要身份证明的，比如出生证明、户口本、身份证、护照等。如果不是实名制，那岂不给拐卖儿童开了方便之门……</p>

<ul>
  <li><strong>如果带了学生证，但磁条不知何故消磁，也无法取票，是否需要退票重购？</strong></li>
</ul>

<p>是的。</p>

<ul>
  <li><strong>身份证丢失可以补办临时乘车证明，学生证可以补办证明么？</strong></li>
</ul>

<p>不可以。</p>

<ul>
  <li><strong>北京南站帮我取票的工作人员是否涉嫌违规？</strong></li>
</ul>

<p><strong>是违规操作</strong>，<strong>在她帮我取票后</strong>，<strong>我有权检举揭发</strong>。</p>

<p>我终于明白大连站的工作人员不帮我取票的原因了，他们大概怕我是个具有正义感的乘客，把他们告发举报了。<strong>不知道是谁（什么）扭曲了谁（什么）</strong>。</p>

<ul>
  <li><strong>按照《规程》规定，似乎只有退票一种选择，相比补票，可否举例说明其优越性？</strong></li>
</ul>

<p>无法解释。<strong>既然选择乘坐铁路出行</strong>，<strong>就要遵守相关规定</strong>。</p>

<p>听到这里，我心头一紧，猛然想到，乘坐汽车、飞机、轮船都有不同公司可以选择，唯独铁路不能呀。</p>

<p>在我看来，在互联网上购买学生票，<strong>除票价稍有优惠</strong>，<strong>无论是从购票速度还是公平性等角度而言</strong>，<strong>学生票都不具备值得提防的特权</strong>。且在车票实名制的今天，依个人浅见，<strong>补票似无法达到车票过户的目的</strong>，那么在相关条例规定下不得不退票重购的“艰难抉择”，又是给谁谋了福祉呢？</p>

<h2 id="section-2">总结</h2>

<p>已经顺利返校，本不必再为此事计较，权当丰富人生阅历，吸取教训即可，更何况毕业在即，再也不会有用到学生票的场景了。不过面对自己琢磨不透的规定，工科生的死理性的毛病又发作起来。在网上查询相关内容，发现有相当一些人与我有类似经历，既然有一定的普遍性，那还是有必要把原因搞清楚。</p>

<p>作为未携带学生证的一方，我自认<strong>理应受到相应的惩罚</strong>，不过如果补票、交罚金的做法能够妥善处理此事，那<strong>退票重购的代价是不是有些重了</strong>？如果不得不退票重购，我也希望获得一个合理的解释。目前看来，12306 客服热线没有办法回答我这一问题，而我此类经验又不多，正考虑借助媒体的力量。</p>

<p>当我感叹自己生活在这样一个日新月异的互联网时代，移动支付、新年红包等手段大行其道的时候，我也不得不面对这样一种现实：学生票优惠凭证还无法与身份证绑定，只是一张可能被消磁的磁条。</p>

<p>想到春节期间新闻报道中，一些 <a href="http://news.sina.com.cn/o/2015-02-15/031931522395.shtml">高速收费处车辆排队200米却不免费放行的新闻</a>，我大约明白了，<strong>权利不是谁授予的</strong>，<strong>而是自己争取的</strong>。</p>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/02/27/fan-xiao-tu-zhong-guan-yu-xue-sheng-piao-de-xiao-cha-qu/">http://frank19900731.github.io/blog/2015/02/27/fan-xiao-tu-zhong-guan-yu-xue-sheng-piao-de-xiao-cha-qu/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 VideoGIF]]></title>
    <link href="http://frank19900731.github.io/blog/2015/02/20/mei-zhou-yi-ruan-zhi-videogif/"/>
    <updated>2015-02-20T19:46:58+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/02/20/mei-zhou-yi-ruan-zhi-videogif</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">功能介绍</h2>

<p><a href="http://www.pearlmountainsoft.com/videogif/">VideoGIF</a> 是一款截取视频内容生成 GIF (Graphics Interchange Format) 格式图片的工具。</p>

<p>VideoGIF 支持</p>

<ul>
  <li>摄像头视频采集；</li>
  <li>拖拽选择待转换内容的起止时间点；</li>
  <li>区域裁剪，自定义图像尺寸；</li>
  <li><strong>添加文字、图像元素</strong>，并设定出现的起止时间；</li>
  <li>调整图片色彩指标，包括亮度、对比度等；</li>
  <li>导出 GIF 时设定帧率/帧数+延迟，可自动优化文件体积。</li>
</ul>

<!-- excerpt end -->

<p><strong>功能界面</strong>：</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/16.png" class="img-up" title="功能界面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/16.png" width="90%" title="功能界面" /></a></p>

<p><strong>导出界面</strong>：</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/17.png" class="img-up" title="导出界面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/17.png" width="90%" title="导出界面" /></a></p>

<p>VideoGIF 可以帮助我们方便地从影视作品中导出<strong>精（dou）彩（bi）</strong>片段，或从录屏中导出一段演示。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/2.gif" class="img-up" title="逗比片段"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/2.gif" width="80%" title="逗比片段" /></a></p>

<p>除视频外，我们可能还需要将多幅图片拼成 GIF，VideoGIF 的制作方相应提供了 <a href="http://www.pearlmountainsoft.com/picgif/">PicGIF</a>，会在 <a href="#section-5">类似软件</a> 中提到。</p>

<h2 id="section-1">界面设计</h2>

<p>简洁美观。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/18.png" class="img-up" title="VideoGIF 界面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/18.png" width="80%" title="VideoGIF 界面" /></a></p>

<h2 id="section-2">易用性</h2>

<p>使用方便，会拖拽起止范围、会设置总帧数/帧率即可。</p>

<h2 id="section-3">稳定性</h2>

<p>稳定性好。</p>

<h2 id="section-4">跨平台</h2>

<p>无。</p>

<h2 id="section-5">类似软件</h2>

<ul>
  <li><a href="http://www.pearlmountainsoft.com/picgif/">PicGIF</a>，根据多幅图片生成 GIF，基本功能如裁剪、调色等同 VideoGIF，也<strong>支持视频输入</strong>，会首先根据用户的起止时间和帧率/帧数设置从视频中提取相应数量的图片，之后处理同多幅图片；</li>
  <li><a href="http://www.helloresolven.com/portfolio/gifbrewery/">GIF Brewery</a>，除界面（略丑），功能与 VideoGIF 完全一致……</li>
  <li><a href="http://www.cockos.com/licecap/">LICEcap</a>，<strong>录屏 + 转 GIF</strong>，损失一些定制灵活性，但操作快捷；</li>
  <li><strong>Photoshop</strong> 可将多幅图片转 GIF，网上有相关 <a href="http://jingyan.baidu.com/article/9158e0006047daa2541228f3.html">教程</a>；</li>
  <li>威锋网上有一篇 <a href="http://bbs.feng.com/read-htm-tid-6980293.html">Mac 下 GIF 制作软件</a> 的讨论，其中的软件在功能、界面上都不超过 VideoGIF、PicGIF；</li>
  <li><strong>命令行工具</strong>，<a href="https://www.ffmpeg.org/">ffmpeg</a>（根据视频生成 GIF 动画）、<a href="http://www.lcdf.org/~eddietwo/gifsicle/">gifsicle</a>（GIF 的创建、拆解、编辑、优化等）
    <ul>
      <li>一个使用案例可见 <a href="http://www.ideawu.net/blog/archives/856.html">OS X 屏幕录制视频转 GIF 动画</a>。</li>
    </ul>
  </li>
</ul>

<h2 id="section-6">闪光点</h2>

<ul>
  <li>功能完善，操作简便。</li>
</ul>

<h2 id="section-7">缺点</h2>

<ul>
  <li>不明白为什么要和 PicGIF 分为两个软件，就为了多挣一分钱么……</li>
</ul>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/02/20/mei-zhou-yi-ruan-zhi-videogif/">http://frank19900731.github.io/blog/2015/02/20/mei-zhou-yi-ruan-zhi-videogif/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 SiteSucker]]></title>
    <link href="http://frank19900731.github.io/blog/2015/02/12/mei-zhou-yi-ruan-zhi-sitesucker/"/>
    <updated>2015-02-12T01:38:02+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/02/12/mei-zhou-yi-ruan-zhi-sitesucker</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">功能介绍</h2>

<p><a href="http://www.sitesucker.us/mac/mac.html">SiteSucker</a> 是一款站点下载软件，<strong>复制站点结构</strong>，<strong>下载相关资源文件</strong>，包括 HTML、JS、CSS、图片、视频等，以方便离线查看。</p>

<p>离线查看主要有两种原因，一种是觉得很有价值，比如 API 文档，需要随时查看；另一种就是网页反应太慢，不如一次性下载完成，本地快速查看。基于第二种原因，我用 SiteSucker 对 <a href="https://www.openproject.org/">OpenProject 站点</a> 做了 <a href="http://frank19900731.github.io/ebook/openproject/">镜像</a>，看起来不错的样子。</p>

<p>作为一款爬虫软件，SiteSucker 的下载设置和 wget、curl 等命令行工具的参数设置是相似的，它的优势主要体现在：</p>

<ol>
  <li>图形化界面操作，免除参数记忆，配置可以保存再利用；</li>
  <li>可以方便地暂停、继续、终止、保存抓取过程；</li>
  <li>自带详细的日志输出，为参数调整提供有价值的参考。</li>
</ol>

<p>图形界面设置的精细程度毕竟不如命令行工具，不过对于常见的教程备份、博客备份等需求，我觉得还是绰绰有余的；而更复杂的任务，可能需要<strong>根据抓取结果迭代调整参数设置</strong>来完成。对于一些 <strong>JS 效果复杂</strong>的网页，可能不仅是 SiteSucker，连 wget 都无法胜任了（因为没法模拟一些人为操作去获取链接）。</p>

<!-- excerpt end -->

<p>接下来，我大概从一个用户需求的角度介绍 SiteSucker 的功能。</p>

<ul>
  <li><strong>首先指定种子 url 作为起始，从抓取页面中提取新的 url 作为接下来的抓取目标，可想而知这个过程可能无穷尽的进行下去，如何界定范围？</strong>
    <ul>
      <li>SiteSucker 对 <code>Path Constraints</code> 提供 5 种设置，假设种子 url 是 http://frank19900731.github.io/wx/archives/
        <ul>
          <li><strong>None</strong>  无限制 ；</li>
          <li><strong>Host</strong>  与种子 url 属同一个（子）域，即 http://frank19900731.github.io/*；</li>
          <li><strong>Subdomains</strong>   可以是其它子域（也包括父域），比如 http://hello.github.io/<em>，http://github.io/</em>，但不可以是国家代码子域，比如（如果有的话）http://frank19900731.github.io.hk；</li>
          <li><strong>Directory</strong>  与种子 url 属于统一路径，即 http://frank19900731.github.io/wx/archives/*；</li>
          <li><strong>Paths Settings</strong>  当前 url + 自定义 <code>Paths Settings</code>。</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>接上条，如何自定义</strong> <code>Paths Settings</code> <strong>?</strong>
    <ul>
      <li><code>Paths to Include</code> &amp; <code>Paths to Exclude</code>，顾名思义定义希望被抓取/不希望被抓取的模式；</li>
      <li>可以采用正则表达式定义；</li>
      <li>不论 <code>Path Constraints</code> 的选择，<code>Paths Settings</code> 始终是生效的，引用 <a href="http://ricks-apps.com/osx/sitesucker/archive/2.x/2.6.x/2.6/manuals/en/pgs/Overview.html">官方教程</a> 的一段话总结 <strong>SiteSucker 如何判定一个 url 是否该被抓取</strong>：</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>If this is the <strong>original URL</strong> (that is, the URL specified in the Web URL text box), then SiteSucker downloads the file.</p>

  <p>Otherwise, if the URL begins with one of the strings (or matches one of the regular expressions) in the <strong>Paths to Exclude</strong> text box, then the file is not downloaded.</p>

  <p>Otherwise, if the URL meets the requirements of the current <strong>Path Constraint</strong> setting, then the file is downloaded.</p>

  <p>Otherwise, if the URL begins with one of the strings (or matches one of the regular expressions) in the <strong>Paths to Include</strong> text box, then SiteSucker downloads the file.</p>

  <p>Otherwise, if the <strong>Include Supporting Files</strong> setting is on and the URL references a non-HTML file type, then SiteSucker downloads the file.</p>

  <p>Otherwise, SiteSucker does not download the file.</p>
</blockquote>

<ul>
  <li><strong>设置了</strong>  <code>Path Constraints</code>、<code>Paths Settings</code>，<strong>但还是可能有抓取遗漏，如何查看漏抓 url ？</strong>
    <ul>
      <li>勾选 <code>Export External Links</code>，下载目录中名为 _ExternalLinks.html 的文件记录了漏抓 url，可以将他们填入 <code>Paths Settings</code>，重新抓取。</li>
    </ul>
  </li>
  <li><strong>一些网站需要登录才能抓取，在 SiteSucker 中如何处理？</strong>
    <ul>
      <li>一种登录方式是<strong>弹出框</strong>，比如路由器管理页面，SiteSucker 会首先查询 Keychain 中的密码记录，如果没有则弹出登陆框让用户输入；</li>
      <li>另一种登录方式是<strong>页面登录</strong>，比如人人网。菜单栏点击 Control -&gt; Open Browser 弹出浏览框，在浏览框中登录即可下载，如下图所示。</li>
    </ul>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-2/14.png" class="img-up" title="登录下载"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/14.png" width="70%" title="登录下载" /></a></p>

<ul>
  <li><strong>不希望抓取某些类型的文件，比如压缩包、视频等，该如何设置？</strong>
    <ul>
      <li><code>File Types</code> 中选择 <code>Disallow Specified File Types</code>，然后指定相关文件类型。</li>
    </ul>
  </li>
  <li><strong>希望同时抓取多个网页，怎样设置连接数？</strong>
    <ul>
      <li>Preferences 中可以设置连接数，如下图。</li>
    </ul>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-2/13.png" class="img-up" title="设置连接数"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/13.png" width="60%" title="设置连接数" /></a></p>

<ul>
  <li><strong>一些站点需要隔段时间抓去一次（比如博客），文件覆盖方式如何设置？</strong>
    <ul>
      <li><code>File Replacement</code> 提供三种选择
        <ul>
          <li><strong>Never</strong>  不覆盖；</li>
          <li><strong>Always</strong>  总是覆盖；</li>
          <li><strong>With Newer</strong>  保留较新的那个。</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>如何将 HTML 中的文件链接（如 JS、CSS）修改为本地引用？</strong>
    <ul>
      <li><code>File Modification</code> 设置为 <strong>Localize</strong></li>
    </ul>
  </li>
  <li><strong>如何突破 robots.txt 的限制（不建议）？</strong>
    <ul>
      <li>勾选 <code>Ignore Robot Exclusions</code>。</li>
    </ul>
  </li>
  <li><strong>如何查看抓取日志？</strong>
    <ul>
      <li><code>Logs</code> 中勾选日志级别，log 文件会生成在已设置的下载文件夹中，有如下格式的记录。分析未抓取链接的原因，进行可能的参数调整。</li>
    </ul>
  </li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>SiteSucker 日志记录</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">2/12/15, 11:55:35 AM - MEDIA TYPE: <span class="s2">&quot;http://frank19900731.github.io/&quot;</span> has a media <span class="nb">type </span>of
</span><span class="line">	text/html
</span><span class="line">...
</span><span class="line">2/12/15, 11:55:35 AM - WARNING: Unable to download <span class="s2">&quot;http://blog.sina.com/frank19900731&quot;</span>,
</span><span class="line">	referenced from <span class="s2">&quot;http://frank19900731.github.io&quot;</span>,
</span><span class="line">	because its path is not allowed
</span><span class="line">2/12/15, 11:55:35 AM - WARNING: Unable to download <span class="s2">&quot;http://weibo.sina.com/frank19900731&quot;</span>,
</span><span class="line">	referenced from <span class="s2">&quot;http://frank19900731.github.io&quot;</span>,
</span><span class="line">	because its path is not allowed
</span><span class="line">...
</span><span class="line">2/12/15, 11:55:35 AM - WARNING: May not be able to follow all links on <span class="s2">&quot;http://frank19900731.github.io&quot;</span>
</span><span class="line">	because it uses JavaScript
</span><span class="line">2/12/15, 11:55:35 AM - HISTORY: Downloaded <span class="s2">&quot;http://frank19900731.github.io&quot;</span>
</span><span class="line">2/12/15, 11:55:35 AM - MEDIA TYPE: <span class="s2">&quot;http://frank19900731.github.io/favicon.ico&quot;</span> has a media <span class="nb">type </span>of
</span><span class="line">	image/x-icon
</span><span class="line">2/12/15, 11:55:36 AM - HISTORY: Downloaded <span class="s2">&quot;http://frank19900731.github.io/favicon.ico&quot;</span>
</span><span class="line">2/12/15, 11:55:36 AM - MEDIA TYPE: <span class="s2">&quot;http://frank19900731.github.io/javascripts/modernizr.custom.js&quot;</span> has a media <span class="nb">type </span>of
</span><span class="line">	application/javascript
</span><span class="line">...
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>其它参数诸如最大扩展层数、默认页面编码、超时设置等都是网页抓取的基本设置，不再讨论。更多功能使用详见 <a href="http://ricks-apps.com/osx/sitesucker/archive/2.x/2.6.x/2.6/manuals/en/pgs/Overview.html">官方教程</a>。</p>

<h2 id="section-1">界面设计</h2>

<p>简单直接。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/15.png" class="img-up" title="SiteSucker 界面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/15.png" width="75%" title="SiteSucker 界面" /></a></p>

<h2 id="section-2">易用性</h2>

<p>如<a href="#section">功能介绍</a>中所述，不同站点的提取难度不尽相同，摸索<strong>一套行之有效的参数</strong>的过程可能会比较复杂。</p>

<h2 id="section-3">稳定性</h2>

<p>稳定性好。</p>

<h2 id="section-4">跨平台</h2>

<p>支持 <a href="http://www.sitesucker.us/ios/ios.html">iOS</a>，网页站点可以打包在 iOS 和 OSX 间传输，对应 File -&gt; (Un)Pack Downloads 的功能。</p>

<h2 id="section-5">类似软件</h2>

<ul>
  <li>命令行工具 <a href="http://curl.haxx.se/">curl</a>、 <a href="https://www.gnu.org/software/wget/">wget</a>
    <ul>
      <li><strong>上手简单</strong>，以 wget 为例，抓取一般站点只需 <code>wget -r -p -np -k url</code> 一条命令；</li>
      <li>深入研究一下，可以进行更精细的设置，也可二次开发；</li>
      <li>也有单条 wget 处理不好的情况，比如一些页面代码中可见 <code>css?v=x.x.x</code> 的写法，一般是为了 <a href="http://blog.csdn.net/zanychou/article/details/8813076">清除客户端缓存</a>，但 wget 会将其直接保存为 <code>css?v=x.x.x</code>（于是离线站点无法加载这一文件），可见这个 <a href="http://superuser.com/questions/703435/using-wget-to-download-css-with-get-params">提问</a>，而不是像 SiteSucker 那样识别并保存为 css 文件。</li>
    </ul>
  </li>
  <li>Adobe Acrobat
    <ul>
      <li>Adobe Acrobat 支持<strong>从网页创建 PDF</strong>，也可以抓取站点，如下图。</li>
    </ul>
  </li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-2/12.png" class="img-up" title="Adobe Acrobat 抓取页面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/12.png" width="80%" title="Adobe Acrobat 抓取页面" /></a></p>

<ul>
  <li><a href="http://www.sentenzadesktop.com/easy-script-copier/">Easy Script Copier</a>
    <ul>
      <li>抓取单个页面及相应的 JS、CSS，<strong>扒取网页格式</strong>很管用。</li>
    </ul>
  </li>
  <li>网页抓取框架，如 <a href="http://nutch.apache.org/">Apache Nutch</a>、<a href="https://github.com/scrapy/scrapy">Scrapy</a> 等，功能自然更强大，对普通用户有较高的使用门槛。然而，对于大多数日常需求，还是有种<strong>大炮打蚊子</strong>的赶脚。</li>
</ul>

<h2 id="section-6">闪光点</h2>

<ul>
  <li>可视化定制，功能丰富，特别是支持<strong>登录抓取</strong>。</li>
</ul>

<h2 id="section-7">缺点</h2>

<p>官网上有介绍 SiteSucker 的 <a href="http://www.sitesucker.us/mac/limitations.html">Limitations</a>。</p>

<p>总的来说是良心之作，硬要说缺点不如说是建议：如果能有一个插件系统，用户可以开发、分享网页处理过程中某个具体处理环节的代码就更好了。</p>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/02/12/mei-zhou-yi-ruan-zhi-sitesucker/">http://frank19900731.github.io/blog/2015/02/12/mei-zhou-yi-ruan-zhi-sitesucker/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[解决 Mac 下 zip 压缩文件在 Windows 中显示乱码的问题]]></title>
    <link href="http://frank19900731.github.io/blog/2015/02/11/jie-jue-mac-xia-zip-ya-suo-wen-jian-zai-windows-xia-xian-shi-luan-ma-de-wen-ti/"/>
    <updated>2015-02-11T21:14:26+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/02/11/jie-jue-mac-xia-zip-ya-suo-wen-jian-zai-windows-xia-xian-shi-luan-ma-de-wen-ti</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">问题描述</a></li>
  <li><a href="#section-1">解决方案</a>    <ul>
      <li><a href="#keka">Keka</a></li>
      <li><a href="#p7zip-">右键菜单添加 p7zip 压缩</a></li>
    </ul>
  </li>
  <li><a href="#section-2">总结</a></li>
  <li><a href="#section-3">附录</a>    <ul>
      <li><a href="#the-unarchiver-cmd-tools-">The Unarchiver Cmd Tools 支持的编码格式</a></li>
    </ul>
  </li>
</ul>

<!-- excerpt start -->

<h2 id="section">问题描述</h2>

<p>Mac 下通过<strong>右键菜单中的 Compress</strong> 生成的压缩包，在 Windows 下解压缩可能出现乱码，如下图所示。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/5.png" class="img-up" title="Windows 上解压缩乱码"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/5.png" width="80%" title="Windows 上解压缩乱码" /></a></p>

<p>知乎上关于这个问题的 <a href="http://www.zhihu.com/question/19646289">解答</a> 是</p>

<blockquote>
  <p>Mac OS X 系统自带的压缩程序对 zip 文件名用 UTF-8 编码，但 zip 文件头中没有声明 PKZIP 高版本增加的 Unicode 位。Windows 会认为文件名是 ANSI 编码，结果显示乱码。</p>
</blockquote>

<p>经过简单的资料阅读和测试，我大概验证了下这种解释。</p>

<!-- excerpt end -->

<p>用 <code>locale</code> 命令查看我的 MBP 系统编码，确实是 UTF-8。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>系统编码</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$&gt;</span> locale
</span><span class="line"><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>
</span><span class="line"><span class="nv">LC_COLLATE</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>
</span><span class="line"><span class="nv">LC_CTYPE</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>
</span><span class="line"><span class="nv">LC_MESSAGES</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>
</span><span class="line"><span class="nv">LC_MONETARY</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>
</span><span class="line"><span class="nv">LC_NUMERIC</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>
</span><span class="line"><span class="nv">LC_TIME</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>
</span><span class="line"><span class="nv">LC_ALL</span><span class="o">=</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>关于 <a href="http://baike.baidu.com/subview/185282/6215666.htm">ANSI 编码</a> ，在中文 Windows 系统中可能是 GBK 编码，而在其他语言的 Windows 系统又可能是别的。可以想见，Mac 下打出的压缩包在不同语言的 Windows 下会<strong>乱得各具特色</strong>。</p>

<p>当然，并不是所有解压缩软件都会一股脑地用 ANSI 编码进行解压。有的解压软件能够<strong>自动识别（文件名）编码</strong>并不确定的时候请使用者选择，比如 Mac 下的 <a href="http://unarchiver.c3.cx/unarchiver">The Unarchiver</a>。根据我在中文 Win7 下的测试，不同的解压缩软件对压缩文件的默认“理解”也是不同的，快压会解出乱码，而 7zip、Winrar 则可以正确解码。</p>

<p>一种直观的想法是，可以<strong>对文件名给出统一编码格式</strong>或者<strong>将编码写进压缩文件供解压缩程序读取</strong>。然而，<a href="http://marcosc.com/2008/12/zip-files-and-encoding-i-hate-you/">Zip files and Encoding – I hate you.</a> 中提到</p>

<blockquote>
  <p>The Zip spec does not seem to know that there are normalization models for UTF-8, when there are actually 4 (or more, because there is some non-standard ones too!). The Zip file gives no guidance as to how file names inside zip files are to be normalized.</p>

  <p>…</p>

  <p>The Zip spec says that the only supported encodings are CP437 and UTF-8, but everyone has ignored that. Implementers just encode file names however they want (usually byte for byte as they are in the OS… </p>
</blockquote>

<p>很遗憾，<strong>Mac 自带的 zip 命令</strong>就属于最后一句中 Implementers。虽然我不是很清楚“<strong>文件头中没有声明 PKZIP 高版本增加的 Unicode 位</strong>”中的细节，不过后来通过比较发现，无乱码和有乱码的 zip 文件，以 16进制方式查看时，文件名中<strong>中文字符的编码是一样的</strong>，<strong>不同之处确实在 zip 文件头</strong>。</p>

<h2 id="section-1">解决方案</h2>

<h3 id="keka">Keka</h3>

<p>知乎 <a href="http://www.zhihu.com/question/19646289">解答</a> 中顺带给出了解决方案</p>

<blockquote>
  <p>解决方法：用第三方软件。我推荐 Keka，支持格式多，加密、分卷、压缩比调节等功能都有，还支持中文菜单和界面。最重要的：免费。详细介绍在 <a href="http://t.cn/hGy98k">http://t.cn/hGy98k</a></p>
</blockquote>

<p>链接里给出的是 <a href="http://www.kekaosx.com/en/">Keka</a> 这个软件，下图是软件运行界面。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/6.png" class="img-up" title="Keka 运行界面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/6.png" width="45%" title="Keka 运行界面" /></a></p>

<p>将需要打入压缩包的文件拖拽到软件界面里即可执行压缩。Keka 可以勾选 <code>Exclude Mac resource forks</code> 选项，这样压缩包中就不会出现 <strong>__MACOSX</strong> 或  <strong>.DS_Store</strong> 文件。经测试，快压的乱码问题也随之消失。</p>

<p>然而，由于此软件图标过于丑陋<strong>甚至会引发不适</strong>，使得一些用户不得不舍弃之。其实把 <code>/Applications/Keka.app/Contents/Resources</code> 下的 icns 图标文件替换下就好了。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/7.png" class="img-up" title="Keka Logo"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/7.png" width="40%" title="Keka Logo" /></a></p>

<p>以上为第一种方法。</p>

<ol>
  <li><a href="http://www.kekaosx.com/en/">Keka</a>，可行。不过每次<strong>打开软件并拖拽文件</strong>的操作会略显繁琐。</li>
  <li>上传到百度文库然后下载，无效。</li>
  <li>使用 YemuZip 等号称与 Windows 兼容的软件，无效，仅能删除 .DS_Store 一类的文件。</li>
  <li>修改后缀 zip 为 rar，无效。</li>
  <li>使用 p7zip 命令行，可行。</li>
</ol>

<p>2 - 4 分别是网上给出的“可行”方案，由于没有触及<strong>文件名编码格式</strong>这个核心问题，所以都不可行。</p>

<p>第 5 种方案 7z 命令行是可行的，且可以集成到右键菜单中，使用方便，下一段中会介绍。其实 <strong>Keka 也是基于 7z 压缩的</strong>，一方面可见 <code>/Applications/Keka.app/Contents/Resources</code> 目录下的可执行文件，另一方面，我对比了 Keka 和 7z 对同一个文本文件的压缩结果，<strong>二进制表示完全一致</strong>。</p>

<h3 id="p7zip-">右键菜单添加 p7zip 压缩</h3>

<p>首先通过 <code>brew install p7zip</code> 安装 p7zip，其它安装方式可见 <a href="http://www.7-zip.org/download.html">官网</a>。</p>

<p>7z 命令的使用方法是</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>7z help</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$&gt;</span> 7z
</span><span class="line">Usage: 7z &lt;<span class="nb">command</span>&gt; <span class="o">[</span>&lt;switches&gt;...<span class="o">]</span> &lt;archive_name&gt; <span class="o">[</span>&lt;file_names&gt;...<span class="o">]</span>
</span><span class="line">       <span class="o">[</span>&lt;@listfiles...&gt;<span class="o">]</span>
</span><span class="line">
</span><span class="line">&lt;Commands&gt;
</span><span class="line">  a: Add files to archive
</span><span class="line">  b: Benchmark
</span><span class="line">  d: Delete files from archive
</span><span class="line">  e: Extract files from archive <span class="o">(</span>without using directory names<span class="o">)</span>
</span><span class="line">  l: List contents of archive
</span><span class="line">  t: Test integrity of archive
</span><span class="line">  u: Update files to archive
</span><span class="line">  x: eXtract files with full paths
</span><span class="line">&lt;Switches&gt;
</span><span class="line">  -ai<span class="o">[</span>r<span class="o">[</span>-|0<span class="o">]]{</span>@listfile|!wildcard<span class="o">}</span>: Include archives
</span><span class="line">  -ax<span class="o">[</span>r<span class="o">[</span>-|0<span class="o">]]{</span>@listfile|!wildcard<span class="o">}</span>: eXclude archives
</span><span class="line">  -bd: Disable percentage indicator
</span><span class="line">  -i<span class="o">[</span>r<span class="o">[</span>-|0<span class="o">]]{</span>@listfile|!wildcard<span class="o">}</span>: Include filenames
</span><span class="line">  -m<span class="o">{</span>Parameters<span class="o">}</span>: <span class="nb">set </span>compression Method
</span><span class="line">  -o<span class="o">{</span>Directory<span class="o">}</span>: <span class="nb">set </span>Output directory
</span><span class="line">  -p<span class="o">{</span>Password<span class="o">}</span>: <span class="nb">set </span>Password
</span><span class="line">  -r<span class="o">[</span>-|0<span class="o">]</span>: Recurse subdirectories
</span><span class="line">  -scs<span class="o">{</span>UTF-8 | WIN | DOS<span class="o">}</span>: <span class="nb">set </span>charset <span class="k">for </span>list files
</span><span class="line">  -sfx<span class="o">[{</span>name<span class="o">}]</span>: Create SFX archive
</span><span class="line">  -si<span class="o">[{</span>name<span class="o">}]</span>: <span class="nb">read </span>data from stdin
</span><span class="line">  -slt: show technical information <span class="k">for </span>l <span class="o">(</span>List<span class="o">)</span> <span class="nb">command</span>
</span><span class="line">  -so: write data to stdout
</span><span class="line">  -ssc<span class="o">[</span>-<span class="o">]</span>: <span class="nb">set </span>sensitive <span class="k">case </span>mode
</span><span class="line">  -t<span class="o">{</span>Type<span class="o">}</span>: Set <span class="nb">type </span>of archive
</span><span class="line">  -u<span class="o">[</span>-<span class="o">][</span>p#<span class="o">][</span>q#<span class="o">][</span>r#<span class="o">][</span>x#<span class="o">][</span>y#<span class="o">][</span>z#<span class="o">][</span>!newArchiveName<span class="o">]</span>: Update options
</span><span class="line">  -v<span class="o">{</span>Size<span class="o">}[</span>b|k|m|g<span class="o">]</span>: Create volumes
</span><span class="line">  -w<span class="o">[{</span>path<span class="o">}]</span>: assign Work directory. Empty path means a temporary directory
</span><span class="line">  -x<span class="o">[</span>r<span class="o">[</span>-|0<span class="o">]]]{</span>@listfile|!wildcard<span class="o">}</span>: eXclude filenames
</span><span class="line">  -y: assume Yes on all queries
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>我们将要用到的参数是</p>

<ul>
  <li>a 添加文件到压缩包；</li>
  <li>-t 压缩文件格式；</li>
  <li>-r 递归调用；</li>
  <li>-xr@ 列表文件，记录不希望被打入压缩包的文件/文件夹的名称。</li>
</ul>

<p>我们希望在 Automator 中创建一个服务，接收文件名或文件夹名作为输入参数，编写脚本调用 7z 命令对输入文件进行压缩并输出到源文件夹；添加这个服务到右键菜单中，用法与系统自带的 Compress 相同，我们将其命名为 <code>Compress with 7z</code>。</p>

<p>一个动态效果是</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/1.gif" class="img-up" title="运行效果"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/1.gif" width="60%" title="运行效果" /></a></p>

<p>以下是具体操作步骤。</p>

<ul>
  <li>打开 Automator，新建服务（Service）；</li>
  <li>Service receives selected <strong>files or folders</strong>, in <strong>any application</strong>；</li>
  <li>搜索框输入 shell，拖拽 Run Shell Script 到右侧；</li>
  <li>输入压缩脚本（之后详述）；</li>
  <li>保存，将这个系统服务命名为 <code>Compress with 7z</code>；</li>
  <li>进入 系统设置（System Preferences），选择 Keyboard -&gt; Shortcuts -&gt; Services，在 Files and Folders 列表中找到 <code>Compress with 7z</code>，勾选，设置快捷键（可选，如果无效则可能是冲突，换个试试）。</li>
</ul>

<p>操作完成后，Automator 的显示为</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/8.png" class="img-up" title="Automator Compress with 7z"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/8.png" width="90%" title="Automator Compress with 7z" /></a></p>

<p>系统设置（System Preferences）显示为</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/10.png" class="img-up" title="系统设置"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/10.png" width="70%" title="系统设置" /></a></p>

<p>右键菜单显示为</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/9.png" class="img-up" title="右键菜单"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/9.png" width="40%" title="右键菜单" /></a></p>

<p>关于<strong>添加右键菜单项</strong>可以参考 <a href="http://www.hongkiat.com/blog/customize-mac-right-click-menu/">Create Customize Shortcut In Mac’s Right Click Menu [Guide]</a>。要注意的是，如果当前操作关联 5 个以上 Service，则这些 Service 会以二级菜单的形式显示，所以尽量在系统设置（System Preferences）-&gt; Keyboard 中把没用的勾选掉。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/11.png" class="img-up" title="右键菜单，Service 较多"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/11.png" width="60%" title="右键菜单，Service 较多" /></a></p>

<p>最后介绍脚本编写，参考自 <a href="http://superuser.com/questions/91147/how-to-set-mac-os-xs-default-compression-format">How to set Mac OS X’s Default Compression Format?</a>，给出代码和注释版代码。</p>

<p>代码</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>压缩脚本</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nb">set</span> -e
</span><span class="line"><span class="nv">compress_method</span><span class="o">=</span><span class="s2">&quot;7z&quot;</span>
</span><span class="line"><span class="o">[[</span> <span class="nv">$# </span><span class="o">=</span> 1 <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">name</span><span class="o">=</span><span class="k">${</span><span class="nv">1</span><span class="p">##*/</span><span class="k">}</span> <span class="o">||</span> <span class="nv">name</span><span class="o">=</span>archive
</span><span class="line"><span class="nv">base</span><span class="o">=</span><span class="k">${</span><span class="nv">1</span><span class="p">%/*</span><span class="k">}</span>
</span><span class="line"><span class="nb">cd</span> <span class="s2">&quot;$base&quot;</span>
</span><span class="line">
</span><span class="line"><span class="nv">i</span><span class="o">=</span>2
</span><span class="line"><span class="o">[[</span> -e <span class="s2">&quot;$name.$compress_method&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;$name-$i&quot;</span>
</span><span class="line"><span class="k">while</span> <span class="o">[[</span> -e <span class="s2">&quot;$name.$compress_method&quot;</span> <span class="o">]]</span>; <span class="k">do </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;${name%??}-$((++i))&quot;</span>; <span class="k">done</span>
</span><span class="line">
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;.DS_Store&quot;</span> &gt;&gt; .exclude_file_list
</span><span class="line">/usr/local/bin/7z a -r -t<span class="s2">&quot;$compress_method&quot;</span> ./<span class="s2">&quot;$name.$compress_method&quot;</span> <span class="s2">&quot;${@#&quot;</span><span class="nv">$base</span><span class="s2">&quot;/}&quot;</span> -xr@.exclude_file_list
</span><span class="line">rm .exclude_file_list
</span><span class="line">open -R ./<span class="s2">&quot;$name.$compress_method&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>注释版代码</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>压缩脚本 注释版</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nb">set</span> -e
</span><span class="line"><span class="c"># 设置压缩文件格式，可以修改为 zip、rar 等</span>
</span><span class="line"><span class="nv">compress_method</span><span class="o">=</span><span class="s2">&quot;7z&quot;</span>
</span><span class="line"><span class="c"># 如果只有一个文件，则将压缩包命名为 文件名.7z；</span>
</span><span class="line"><span class="c"># 如果有多个文件，则将压缩包命名为 archive.7z。</span>
</span><span class="line"><span class="c"># ${1##*/} 的写法是路径模式匹配，参见 http://blog.sina.com.cn/s/blog_ac9fdc0b0101ls9n.html</span>
</span><span class="line"><span class="o">[[</span> <span class="nv">$# </span><span class="o">=</span> 1 <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">name</span><span class="o">=</span><span class="k">${</span><span class="nv">1</span><span class="p">##*/</span><span class="k">}</span> <span class="o">||</span> <span class="nv">name</span><span class="o">=</span>archive
</span><span class="line"><span class="c"># ${1%/*} 仍是路径模式匹配，获得待压缩文件、文件夹所在的文件夹</span>
</span><span class="line"><span class="nv">base</span><span class="o">=</span><span class="k">${</span><span class="nv">1</span><span class="p">%/*</span><span class="k">}</span>
</span><span class="line"><span class="nb">cd</span> <span class="s2">&quot;$base&quot;</span>
</span><span class="line">
</span><span class="line"><span class="c"># 新压缩包编号递增，防止重名</span>
</span><span class="line"><span class="nv">i</span><span class="o">=</span>2
</span><span class="line"><span class="o">[[</span> -e <span class="s2">&quot;$name.$compress_method&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;$name-$i&quot;</span>
</span><span class="line"><span class="c"># ${name%??} 仍是路径模式匹配，删除最后两个字符，可以想见，编号是两位数及以上就不对了，不过 0-9 共 10 个也是够了</span>
</span><span class="line"><span class="k">while</span> <span class="o">[[</span> -e <span class="s2">&quot;$name.$compress_method&quot;</span> <span class="o">]]</span>; <span class="k">do </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;${name%??}-$((++i))&quot;</span>; <span class="k">done</span>
</span><span class="line">
</span><span class="line"><span class="c"># 创建列表文件，该文件记录不希望被打入压缩包的文件/文件夹的名称，可以使用正则表达式</span>
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;.DS_Store&quot;</span> &gt;&gt; .exclude_file_list
</span><span class="line"><span class="c"># 调用 7z 进行压缩</span>
</span><span class="line"><span class="c"># ${@#&quot;$base&quot;/} 是路径匹配，去除输入的文件列表的路径前缀</span>
</span><span class="line"><span class="c"># -xr@.exclude_file_list 指定列表文件</span>
</span><span class="line">/usr/local/bin/7z a -r -t<span class="s2">&quot;$compress_method&quot;</span> ./<span class="s2">&quot;$name.$compress_method&quot;</span> <span class="s2">&quot;${@#&quot;</span><span class="nv">$base</span><span class="s2">&quot;/}&quot;</span> -xr@.exclude_file_list
</span><span class="line"><span class="c"># 删除列表文件</span>
</span><span class="line">rm .exclude_file_list
</span><span class="line"><span class="c"># 打开 Finder，显示压缩结果</span>
</span><span class="line">open -R ./<span class="s2">&quot;$name.$compress_method&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-2">总结</h2>

<p>本文总结、探讨了网上关于 <strong>Mac 下的 Zip 压缩包在 Windows 中显示乱码</strong>这一问题的成因与解决方案，并提出了一个<strong>右键菜单添加 p7zip 压缩</strong>的解决方案。</p>

<p>最后，要推荐 <a href="http://unarchiver.c3.cx/commandline">The Unarchiver Cmd Tools</a>，支持不同平台、支持文件名编码的自动识别或指定编码，相信会对常在 Linux、Windows 间转运压缩包的同学有所帮助。</p>

<h2 id="section-3">附录</h2>

<h3 id="the-unarchiver-cmd-tools-">The Unarchiver Cmd Tools 支持的编码格式</h3>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>支持的编码格式</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
<span class="line-number">58</span>
<span class="line-number">59</span>
<span class="line-number">60</span>
<span class="line-number">61</span>
<span class="line-number">62</span>
<span class="line-number">63</span>
<span class="line-number">64</span>
<span class="line-number">65</span>
<span class="line-number">66</span>
<span class="line-number">67</span>
<span class="line-number">68</span>
<span class="line-number">69</span>
<span class="line-number">70</span>
<span class="line-number">71</span>
<span class="line-number">72</span>
<span class="line-number">73</span>
<span class="line-number">74</span>
<span class="line-number">75</span>
<span class="line-number">76</span>
<span class="line-number">77</span>
<span class="line-number">78</span>
<span class="line-number">79</span>
<span class="line-number">80</span>
<span class="line-number">81</span>
<span class="line-number">82</span>
<span class="line-number">83</span>
<span class="line-number">84</span>
<span class="line-number">85</span>
<span class="line-number">86</span>
<span class="line-number">87</span>
<span class="line-number">88</span>
<span class="line-number">89</span>
<span class="line-number">90</span>
<span class="line-number">91</span>
<span class="line-number">92</span>
<span class="line-number">93</span>
<span class="line-number">94</span>
<span class="line-number">95</span>
<span class="line-number">96</span>
<span class="line-number">97</span>
<span class="line-number">98</span>
<span class="line-number">99</span>
<span class="line-number">100</span>
<span class="line-number">101</span>
<span class="line-number">102</span>
<span class="line-number">103</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$&gt;</span> unar -encoding list
</span><span class="line">Available encodings are:
</span><span class="line">  * macintosh: Western <span class="o">(</span>Mac OS Roman<span class="o">)</span>
</span><span class="line">  * x-mac-japanese: Japanese <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-trad-chinese: Traditional Chinese <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-korean: Korean <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-arabic: Arabic <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-hebrew: Hebrew <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-greek: Greek <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-cyrillic: Cyrillic <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-devanagari: Devanagari <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-gurmukhi: Gurmukhi <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-gujarati: Gujarati <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-thai: Thai <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-simp-chinese: Simplified Chinese <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-tibetan: Tibetan <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-centraleurroman: Central European <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-symbol: Symbol <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-dingbats: Dingbats <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-turkish: Turkish <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-croatian: Croatian <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-icelandic: Icelandic <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-romanian: Romanian <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-celtic: Celtic <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-gaelic: Gaelic <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-farsi: Farsi <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * x-mac-ukrainian: Cyrillic <span class="o">(</span>Mac OS Ukrainian<span class="o">)</span>
</span><span class="line">  * x-mac-inuit: Inuit <span class="o">(</span>Mac OS<span class="o">)</span>
</span><span class="line">  * utf-16: Unicode <span class="o">(</span>UTF-16<span class="o">)</span>
</span><span class="line">  * utf-7: Unicode <span class="o">(</span>UTF-7<span class="o">)</span>
</span><span class="line">  * utf-8: Unicode <span class="o">(</span>UTF-8<span class="o">)</span>
</span><span class="line">  * utf-32: Unicode <span class="o">(</span>UTF-32<span class="o">)</span>
</span><span class="line">  * utf-16be: Unicode <span class="o">(</span>UTF-16BE<span class="o">)</span>
</span><span class="line">  * utf-16le: Unicode <span class="o">(</span>UTF-16LE<span class="o">)</span>
</span><span class="line">  * utf-32be: Unicode <span class="o">(</span>UTF-32BE<span class="o">)</span>
</span><span class="line">  * utf-32le: Unicode <span class="o">(</span>UTF-32LE<span class="o">)</span>
</span><span class="line">  * iso-8859-1: Western <span class="o">(</span>ISO Latin 1<span class="o">)</span>
</span><span class="line">  * iso-8859-2: Central European <span class="o">(</span>ISO Latin 2<span class="o">)</span>
</span><span class="line">  * iso-8859-3: Western <span class="o">(</span>ISO Latin 3<span class="o">)</span>
</span><span class="line">  * iso-8859-4: Central European <span class="o">(</span>ISO Latin 4<span class="o">)</span>
</span><span class="line">  * iso-8859-5: Cyrillic <span class="o">(</span>ISO 8859-5<span class="o">)</span>
</span><span class="line">  * iso-8859-6: Arabic <span class="o">(</span>ISO 8859-6<span class="o">)</span>
</span><span class="line">  * iso-8859-7: Greek <span class="o">(</span>ISO 8859-7<span class="o">)</span>
</span><span class="line">  * iso-8859-8: Hebrew <span class="o">(</span>ISO 8859-8<span class="o">)</span>
</span><span class="line">  * iso-8859-9: Turkish <span class="o">(</span>ISO Latin 5<span class="o">)</span>
</span><span class="line">  * iso-8859-10: Nordic <span class="o">(</span>ISO Latin 6<span class="o">)</span>
</span><span class="line">  * iso-8859-11: Thai <span class="o">(</span>ISO 8859-11<span class="o">)</span>
</span><span class="line">  * iso-8859-13: Baltic <span class="o">(</span>ISO Latin 7<span class="o">)</span>
</span><span class="line">  * iso-8859-14: Celtic <span class="o">(</span>ISO Latin 8<span class="o">)</span>
</span><span class="line">  * iso-8859-15: Western <span class="o">(</span>ISO Latin 9<span class="o">)</span>
</span><span class="line">  * iso-8859-16: Romanian <span class="o">(</span>ISO Latin 10<span class="o">)</span>
</span><span class="line">  * cp437: Latin-US <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp737: Greek <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp775: Baltic <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp850: Western <span class="o">(</span>DOS Latin 1<span class="o">)</span>
</span><span class="line">  * cp851: Greek <span class="o">(</span>DOS Greek 1<span class="o">)</span>
</span><span class="line">  * cp852: Central European <span class="o">(</span>DOS Latin 2<span class="o">)</span>
</span><span class="line">  * cp855: Cyrillic <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp857: Turkish <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp860: Portuguese <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp861: Icelandic <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp862: Hebrew <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp863: Canadian French <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp864: Arabic <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp865: Nordic <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp866: Russian <span class="o">(</span>DOS<span class="o">)</span>
</span><span class="line">  * cp869: Greek <span class="o">(</span>DOS Greek 2<span class="o">)</span>
</span><span class="line">  * cp874: Thai <span class="o">(</span>Windows, DOS<span class="o">)</span>
</span><span class="line">  * cp932: Japanese <span class="o">(</span>Windows, DOS<span class="o">)</span>
</span><span class="line">  * cp936: Simplified Chinese <span class="o">(</span>Windows, DOS<span class="o">)</span>
</span><span class="line">  * cp949: Korean <span class="o">(</span>Windows, DOS<span class="o">)</span>
</span><span class="line">  * cp950: Traditional Chinese <span class="o">(</span>Windows, DOS<span class="o">)</span>
</span><span class="line">  * windows-1252: Western <span class="o">(</span>Windows Latin 1<span class="o">)</span>
</span><span class="line">  * windows-1250: Central European <span class="o">(</span>Windows Latin 2<span class="o">)</span>
</span><span class="line">  * windows-1251: Cyrillic <span class="o">(</span>Windows<span class="o">)</span>
</span><span class="line">  * windows-1253: Greek <span class="o">(</span>Windows<span class="o">)</span>
</span><span class="line">  * windows-1254: Turkish <span class="o">(</span>Windows Latin 5<span class="o">)</span>
</span><span class="line">  * windows-1255: Hebrew <span class="o">(</span>Windows<span class="o">)</span>
</span><span class="line">  * windows-1256: Arabic <span class="o">(</span>Windows<span class="o">)</span>
</span><span class="line">  * windows-1257: Baltic <span class="o">(</span>Windows<span class="o">)</span>
</span><span class="line">  * windows-1258: Vietnamese <span class="o">(</span>Windows<span class="o">)</span>
</span><span class="line">  * us-ascii: Western <span class="o">(</span>ASCII<span class="o">)</span>
</span><span class="line">  * Shift_JIS: Japanese <span class="o">(</span>Shift JIS X0213<span class="o">)</span>
</span><span class="line">  * GBK: Chinese <span class="o">(</span>GBK<span class="o">)</span>
</span><span class="line">  * gb18030: Chinese <span class="o">(</span>GB 18030<span class="o">)</span>
</span><span class="line">  * iso-2022-jp: Japanese <span class="o">(</span>ISO 2022-JP<span class="o">)</span>
</span><span class="line">  * iso-2022-jp-2: Japanese <span class="o">(</span>ISO 2022-JP-2<span class="o">)</span>
</span><span class="line">  * iso-2022-jp-1: Japanese <span class="o">(</span>ISO 2022-JP-1<span class="o">)</span>
</span><span class="line">  * iso-2022-cn: Chinese <span class="o">(</span>ISO 2022-CN<span class="o">)</span>
</span><span class="line">  * iso-2022-kr: Korean <span class="o">(</span>ISO 2022-KR<span class="o">)</span>
</span><span class="line">  * euc-jp: Japanese <span class="o">(</span>EUC<span class="o">)</span>
</span><span class="line">  * gb2312: Simplified Chinese <span class="o">(</span>GB 2312<span class="o">)</span>
</span><span class="line">  * euc-tw: Traditional Chinese <span class="o">(</span>EUC<span class="o">)</span>
</span><span class="line">  * euc-kr: Korean <span class="o">(</span>EUC<span class="o">)</span>
</span><span class="line">  * shift_jis: Japanese <span class="o">(</span>Shift JIS<span class="o">)</span>
</span><span class="line">  * koi8-r: Cyrillic <span class="o">(</span>KOI8-R<span class="o">)</span>
</span><span class="line">  * big5: Traditional Chinese <span class="o">(</span>Big 5<span class="o">)</span>
</span><span class="line">  * x-mac-roman-latin1: Western <span class="o">(</span>Mac Mail<span class="o">)</span>
</span><span class="line">  * hz-gb-2312: Simplified Chinese <span class="o">(</span>HZ GB 2312<span class="o">)</span>
</span><span class="line">  * big5-hkscs: Traditional Chinese <span class="o">(</span>Big 5 HKSCS<span class="o">)</span>
</span><span class="line">  * koi8-u: Ukrainian <span class="o">(</span>KOI8-U<span class="o">)</span>
</span><span class="line">  * x-nextstep: Western <span class="o">(</span>NextStep<span class="o">)</span>
</span><span class="line">  * ibm037: Western <span class="o">(</span>EBCDIC Latin 1<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/02/11/jie-jue-mac-xia-zip-ya-suo-wen-jian-zai-windows-xia-xian-shi-luan-ma-de-wen-ti/">http://frank19900731.github.io/blog/2015/02/11/jie-jue-mac-xia-zip-ya-suo-wen-jian-zai-windows-xia-xian-shi-luan-ma-de-wen-ti/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 Blotter]]></title>
    <link href="http://frank19900731.github.io/blog/2015/02/08/mei-zhou-yi-ruan-zhi-blotter/"/>
    <updated>2015-02-08T21:13:06+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/02/08/mei-zhou-yi-ruan-zhi-blotter</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">功能介绍</h2>

<p><a href="http://wireload.net/products/blotter/">Blotter</a> 是一款桌面日历软件，功能是将 Mac 自带 Calendar 软件的内容显示于桌面，作为提醒、便于查看。</p>

<p>运行效果如下</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/1.png" class="img-up" title="Blotter 运行效果"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/1.png" width="90%" title="Blotter 运行效果" /></a></p>

<p>从上到下，从左到右，依次显示的是<strong>日期</strong>、<strong>Reminders 待办事项</strong>、<strong>当前任务</strong>、<strong>日历提醒</strong>（节假日、纪念日等）和周任务视图。显示区域、大小及内在布局可调整。</p>

<p>上图是日历的前景显示模式，可清楚查看任务描述，也可设定日历过一段时间<strong>暗淡显示</strong>，以突出桌面背景。</p>

<!-- excerpt end -->

<p>通过快捷键，用户可以</p>

<ul>
  <li>使日历前景显示；</li>
  <li>查看上周/下周事项；</li>
  <li>添加任务事项。</li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-2/2.png" class="img-up" title="Blotter 添加任务事项"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/2.png" width="70%" title="Blotter 添加任务事项" /></a></p>

<h2 id="section-1">界面设计</h2>

<p>界面美观，布局调整随意，主题无法设置。</p>

<h2 id="section-2">易用性</h2>

<p>简单易用。</p>

<h2 id="section-3">稳定性</h2>

<p>无崩溃体验。</p>

<h2 id="section-4">跨平台</h2>

<p>无。</p>

<h2 id="section-5">类似软件</h2>

<p>桌面日历软件尚有 DateLine、Rainlendar、<a href="http://www.chronosnet.com/Products/spotlife.html">Spotlife</a> 可供选择，不过前两个软件的颜值实在不敢恭维。</p>

<p>相比 Blotter， Spotlife 的最大优势在于<strong>界面可定制性更强</strong>，</p>

<ul>
  <li>可设置天气显示；</li>
  <li>提供主题选择和背景颜色的简单定制；</li>
  <li>提供四种组织方式：<strong>日程</strong>（紧凑的事项列表）、<strong>日</strong>、<strong>周</strong>、<strong>月</strong>。</li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-2/4.png" class="img-up" title="Spotlife 设置"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/4.png" width="70%" title="Spotlife 设置" /></a></p>

<p>下图是周组织视图。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-2/3.png" class="img-up" title="Spotlife 运行效果"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-2/3.png" width="90%" title="Spotlife 运行效果" /></a></p>

<p>Spotlife 未提供新事项添加功能。</p>

<h2 id="section-6">闪光点</h2>

<p>默认界面美观，布局合理。</p>

<h2 id="section-7">缺点</h2>

<p>未提供样式自定义选项。</p>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/02/08/mei-zhou-yi-ruan-zhi-blotter/">http://frank19900731.github.io/blog/2015/02/08/mei-zhou-yi-ruan-zhi-blotter/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 Blocs]]></title>
    <link href="http://frank19900731.github.io/blog/2015/01/31/mei-zhou-yi-ruan-zhi-blocs/"/>
    <updated>2015-01-31T16:19:58+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/01/31/mei-zhou-yi-ruan-zhi-blocs</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">功能介绍</h2>

<p><a href="http://blocsapp.com/">Blocs</a> 是一款拖拽式网页生成器，页面布局基于 Bootstrap，主要帮助用户生成 <a href="https://www.meteor.com/">此类样式</a> 的页面（Blocs <a href="http://blocsapp.com/">官方主页</a> 也是这种风格）。这款工具<strong>用户友好度很高</strong>，<strong>不会网页编程</strong>或者<strong>对 Bootstrap 不熟悉</strong>人可以用它快速定制特定风格的主页（可用作产品介绍、个人主页或博客模板），之后可在导出的网页代码基础上进行二次开发，实现<strong>布局调整</strong>或<strong>动态效果</strong>。</p>

<p>软件使用的大致思路是</p>

<ul>
  <li>创建一个 <strong>Web Page</strong>，用户可以在上面划分不同的 <strong>Bloc</strong>，页首导航（一个）、中部内容（多个）、页尾信息（多个），分别有<strong>布局模板</strong>供选择；</li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-1/20.png" class="img-up" title="添加 Bloc"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/20.png" width="90%" title="添加 Bloc" /></a></p>

<!-- excerpt end -->

<ul>
  <li>在每个 <strong>Bloc</strong> 中可以添加 <strong>Brics</strong>，也就是文本、图片、按钮、链接等内容；</li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-1/21.png" class="img-up" title="添加 Bric"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/21.png" width="90%" title="添加 Bric" /></a></p>

<ul>
  <li>对于 <strong>Page</strong>、<strong>Bloc</strong>、<strong>Brics</strong>，都可以进一步设置属性以调整显示效果。</li>
</ul>

<p><a href="http://frank19900731.github.io/img/post/2015-1/22.png" class="img-up" title="Image 控件的属性"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/22.png" width="90%" title="Image 控件的属性" /></a></p>

<p>页面设置完成，可导出包含 HTML、图片、CSS、Javascript 等文件在内的文件夹，上传网页服务器供访问。</p>

<p>在此附上我用 Blocs 制作的 <a href="http://frank19900731.github.io/demo/poem/index.html">Demo</a>，配图、配色比较马虎……</p>

<h2 id="section-1">界面设计</h2>

<p>美观精致。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/19.png" class="img-up" title="软件界面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/19.png" width="90%" title="软件界面" /></a></p>

<h2 id="section-2">易用性</h2>

<p>简单易用。</p>

<h2 id="section-3">稳定性</h2>

<p>未发现崩溃。</p>

<h2 id="section-4">跨平台</h2>

<p>无。</p>

<h2 id="section-5">类似软件</h2>

<p>程序员可能会选用 <a href="http://www.jetbrains.com/webstorm/">WebStorm</a>、<a href="http://www.sublimetext.com/">Sublime</a> 等软件作为自己网页编程的 IDE，而小白用户则需要借助类似 Blocs 的软件，从而实现少写代码、甚至不写代码制作网页的目的。这些快捷工具在应付简单任务的时候可能比 Webstorm、Sublime 等更高效，所以我自己也会用到。它们大致可以分为四类，✔︎ <strong>表示推荐</strong>。</p>

<ul>
  <li>编码式
    <ul>
      <li>✔︎ <a href="http://xpressive.org/">Xpressive</a>，定制细致，适合网页开发初学者；</li>
      <li><a href="http://www.panic.com/coda/">Coda</a>，较简陋；</li>
    </ul>
  </li>
  <li>拖拽式
    <ul>
      <li>✔︎ <a href="http://www.macaw.co/">Macaw</a>，适合设计师使用；</li>
      <li>✔︎ <a href="http://www.google.com/webdesigner/">Google Web Designer</a>，翻墙可用，有详细的<a href="https://support.google.com/webdesigner/?hl=zh-Hans#topic=3178270">帮助文档</a>；</li>
      <li><a href="http://sparkle.cx/">Sparkle</a>，比 Macaw 功能简单，也不错；</li>
      <li><a href="http://www.karelia.com/products/sandvox/">Sandvox</a>，样式老套；</li>
      <li><a href="http://www.softpress.com/freeway-pro/">Freeway Pro</a>，样式老套；</li>
    </ul>
  </li>
  <li>混合式
    <ul>
      <li>✔︎ <a href="http://muse.adobe.com/">Adobe Muse</a>，教程多多，功能强大，<strong>非常推荐</strong>；</li>
      <li><a href="http://realmacsoftware.com/rapidweaver">Rapid Weaver</a>，功能普通；</li>
      <li><a href="http://www.theescapers.com/lucid/index.html">Lucid</a>，非网页设计，官方介绍相当于一个 JavaScript Lego，可视化添加 JS 动态效果，比如 json 文件的异步加载、处理；</li>
      <li><a href="http://www.theescapers.com/flux/index.html">Flux</a>，和 Lucid 属于同一公司，样式老套；</li>
    </ul>
  </li>
  <li>模板管理式
    <ul>
      <li>✔︎ <a href="http://cactusformac.com/">Cactus</a>，使用 Django 模板生成博客、相册、个人信息三种静态网站，样式简单，但<strong>清新耐看</strong>；</li>
      <li>✔︎ <a href="http://www.getblogo.com/">Blogo</a>，WordPress 站点管理，PC 端查看、编写、发布；</li>
      <li><a href="http://serverpress.com/products/desktopserver/">Desktop Server</a>，WordPress 部署与管理，小白专属。</li>
    </ul>
  </li>
</ul>

<h2 id="section-6">闪光点</h2>

<ul>
  <li>较短时间的学习、操作就可以生成<strong>美观</strong>、<strong>实用</strong>的网页，这是它相比类似软件最大的优势。</li>
</ul>

<h2 id="section-7">缺点</h2>

<ul>
  <li>网页元素的属性定制还不够丰富（比如网页标题都无处修改），希望<strong>允许添加 CSS 代码</strong>（像 Xpressive 那样）；</li>
  <li>用户无法添加模板，只能使用软件自带的，想修改布局，只能去编辑导出的网页；</li>
  <li>拖拽式编辑器，没有代码查看、编辑的功能，至少可以<strong>增加一个使用其它编辑器打开的按键</strong>，方便二次开发。</li>
</ul>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/01/31/mei-zhou-yi-ruan-zhi-blocs/">http://frank19900731.github.io/blog/2015/01/31/mei-zhou-yi-ruan-zhi-blocs/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mac 下安装 WeCenter 并添加代码高亮功能]]></title>
    <link href="http://frank19900731.github.io/blog/2015/01/26/mac-xia-an-zhuang-wecenter-bing-tian-jia-dai-ma-gao-liang-gong-neng/"/>
    <updated>2015-01-26T02:02:10+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/01/26/mac-xia-an-zhuang-wecenter-bing-tian-jia-dai-ma-gao-liang-gong-neng</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#wecenter">为什么选择 WeCenter</a></li>
  <li><a href="#wecenter-">WeCenter 安装</a></li>
  <li><a href="#section">代码高亮定制</a></li>
  <li><a href="#section-1">参考代码</a></li>
</ul>

<!-- excerpt start -->

<h2 id="wecenter">为什么选择 WeCenter</h2>

<p>最近考虑将部分笔记任务从 Ulysses 中分离出来，于是想到给自己建一个类似知乎的问答系统。我会将对一些<strong>技术问题的解决和概念理解</strong>录入问答系统，可视化界面和搜索功能方便自己日后查看、查询。</p>

<p>一圈 <a href="http://www.oschina.net/project/tag/299/qa">选下来</a>，觉得 WeCenter 不错，主要考虑到</p>

<ul>
  <li>界面更美观，也有 <a href="http://www.wecenter.com/category/templates/">模板</a>，无须太多定制；</li>
  <li>PHP + mysql + Bootstrap，对我而言二次开发上手容易些；</li>
  <li>功能、界面与知乎类似，满足我的全部需求。</li>
</ul>

<h2 id="wecenter-">WeCenter 安装</h2>

<p>接下来就是 <a href="http://www.wecenter.com/downloads/">下载</a> 安装。WeCenter 要求 PHP 支持 FreeType 以显示验证码，而 Mac 自带的 PHP 无此支持，所以需要重新编译 PHP。</p>

<p>采用 homebrew 安装方式，方便今后管理 PHP 的其它扩展支持，具体安装方式如下。</p>

<!-- excerpt end -->

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>使用 brew 编译安装 PHP</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">brew update
</span><span class="line">brew tap homebrew/dupes
</span><span class="line">brew tap josegonzalez/homebrew-php
</span><span class="line">brew install php55 --with-gmp --with-imap --with-tidy --with-debug --with-mysql<span class="o">=</span>/usr/local/mysql --without-snmp
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>mysql 是我从 <a href="http://dev.mysql.com/downloads/mysql/">官网</a> 下载安装包安装的，默认路径是 <code>/usr/local/mysql</code>；<code>--without-snmp</code> 选项的加入可以消除 <strong>Error 139 - make: *** [ext/phar/phar.php]</strong> 的编译问题，不影响后续使用。关于这个编译问题，网上有说可以通过 <code>brew uninstall openssl</code> 解决，不过尝试无效，还有说清空 brew 所有安装，感觉代价太大了……</p>

<p><code>brew options php55</code> 查看其它编译选项。brew 会自动下载安装 FreeType、jpeg 等模块，然后编译 PHP 5.5。 </p>

<p>编译成功后，在 <code>/usr/local/Cellar/php55/5.5.20/libexec/apache2</code> 目录下会存在一个名为 <code>libphp5.so</code> 的模块，可用于在 apache 的配置文件中替换系统 PHP。</p>

<p>我所使用的 apache 是 <a href="http://www.apple.com/osx/server/">Server</a>  自带的，考虑到它提供很多应用支持，比如 VPN、Wiki 等。配置文件不是通常的 httpd.conf，而是 <code>/Library/Server/Web/Config/apache2/httpd_server_app.conf</code>，修改如下。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>修改 apache 配置文件</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="c"># LoadModule php5_module libexec/apache2/libphp5.so</span>
</span><span class="line">LoadModule php5_module /usr/local/Cellar/php55/5.5.20/libexec/apache2/libphp5.so
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>当然，要注意配置文件修改前后 apache 的关闭与重启。</p>

<h2 id="section">代码高亮定制</h2>

<p>WeCenter 基本设置容易上手，<a href="http://wenda.wecenter.com/">社区</a> 里有不少介绍，只是在代码高亮定制方面，官方未提供，社区讨论也少，缺乏适用于新版本 WeCenter 的方法。在这个 <a href="http://wenda.wecenter.com/question/22147">问题</a> 的启发下，自己初步实现了<strong>对 WeCenter 3.0.2 的代码高亮支持</strong>。</p>

<p><a href="http://wenda.wecenter.com/question/22147">问题</a> 中的做法是使用 <a href="http://qbnz.com/highlighter/">GeSHi</a> 进行代码渲染，MediaWiki 选用的也是这个。将 <a href="http://wenda.wecenter.com/question/22147">问题</a> 提供的 <a href="http://wenda.wecenter.com/file/download/file_name-U2VydmljZXMuemlw__url-aHR0cDovL3dlbmRhLndlY2VudGVyLmNvbS91cGxvYWRzL3F1ZXN0aW9ucy8yMDE1MDEyNC9jMzIxNzNkZWY5MzA2N2IwMjFhYjIzMDUyYmNiYTZmYQ==">代码</a> 解压缩到 <code>wecenter-root/system/Services</code> 中，<strong>注意不要覆盖 Markdown.php</strong>，我们要自己修改，操作步骤如下，文末附有参考代码压缩包。</p>

<ul>
  <li>在 Markdown.php 头部引入 GeSHi Parser。</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>引入GeSHi Parser</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="k">include</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;/Services/geshi/geshi.php&#39;</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="c1">// Load umodified Michel Fortin&#39;s PHP Markdown Extra: http://michelf.com/projects/php-markdown/</span>
</span><span class="line"><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;MARKDOWN_PARSER_CLASS&#39;</span><span class="p">,</span>  <span class="s1">&#39;MarkdownExtraGeshi_Parser&#39;</span><span class="p">);</span>
</span><span class="line"><span class="k">include</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;/Services/markdown_extra/markdown.php&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<ul>
  <li>原样添加 <a href="http://wenda.wecenter.com/question/22147">问题</a> 代码中调用 GeSHi Parser 进行代码解析的函数 syntaxHighlight 。</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>调用 GeSHi Parser 进行代码解析</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="k">protected</span> <span class="k">function</span> <span class="nf">syntaxHighlight</span><span class="p">(</span><span class="nv">$matches</span><span class="p">)</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">	<span class="nv">$geshi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GeSHi</span><span class="p">(</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">?</span> <span class="s2">&quot;txt&quot;</span> <span class="o">:</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
</span><span class="line">	<span class="k">return</span> <span class="nv">$geshi</span><span class="o">-&gt;</span><span class="na">parse_code</span><span class="p">();</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<ul>
  <li>修改 _doCodeBlocks_callback 函数。</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>_doCodeBlocks_callback</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="k">protected</span> <span class="k">function</span> <span class="nf">_doCodeBlocks_callback</span><span class="p">(</span><span class="nv">$matches</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">	<span class="nv">$codeblock</span> <span class="o">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span class="line">
</span><span class="line">	<span class="c1"># outdent 会去掉行首tab/多空格，不采用，直接按照输入代码样式来，建议代码缩进为2空格</span>
</span><span class="line">	<span class="c1">// $codeblock = $this-&gt;outdent($codeblock);</span>
</span><span class="line">	<span class="c1">// $codeblock = htmlspecialchars($codeblock, ENT_NOQUOTES);</span>
</span><span class="line">
</span><span class="line">	<span class="c1"># trim leading newlines and trailing newlines</span>
</span><span class="line">	<span class="nv">$codeblock</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;/\A\n+|\n+\z/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$codeblock</span><span class="p">);</span>
</span><span class="line">	
</span><span class="line">	<span class="c1"># 替换特殊字符，可能不完善</span>
</span><span class="line">	<span class="nv">$codeblock</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
</span><span class="line">		<span class="s1">&#39;&amp;lt;&#39;</span><span class="p">,</span>
</span><span class="line">		<span class="s1">&#39;&amp;quot;&#39;</span><span class="p">,</span>
</span><span class="line">		<span class="s1">&#39;&amp;amp;&#39;</span>
</span><span class="line">	<span class="p">),</span> <span class="k">array</span><span class="p">(</span>
</span><span class="line">		<span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>
</span><span class="line">		<span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
</span><span class="line">		<span class="s1">&#39;&amp;&#39;</span>
</span><span class="line">	<span class="p">),</span> <span class="nv">$codeblock</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">	<span class="c1">## call geshi to render the code</span>
</span><span class="line">	<span class="nv">$codeblock</span> <span class="o">=</span> <span class="nb">preg_replace_callback</span><span class="p">(</span>
</span><span class="line">		<span class="s1">&#39;/^(\{\{lang:([\w]+)\}\}\n|)(.*?)$/s&#39;</span><span class="p">,</span> <span class="c1">// greedy_code</span>
</span><span class="line">		<span class="k">array</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;syntaxHighlight&#39;</span><span class="p">),</span>
</span><span class="line">		<span class="nv">$codeblock</span>
</span><span class="line">	<span class="p">);</span>
</span><span class="line">
</span><span class="line">	<span class="c1">// 将代码每一行包裹入 &lt;p&gt;</span>
</span><span class="line">	<span class="nv">$codeblock</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;/^(.+?)$/m&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;p&gt;${1}&lt;/p&gt;&#39;</span><span class="p">,</span> <span class="nv">$codeblock</span><span class="p">);</span>
</span><span class="line">	<span class="nv">$codeblock</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span> <span class="c1"># 特殊处理第一行和最后一行</span>
</span><span class="line">		<span class="s1">&#39;style=&quot;font-family:monospace;&quot;&gt;&#39;</span><span class="p">,</span>
</span><span class="line">		<span class="s1">&#39;&lt;/pre&gt;&#39;</span>
</span><span class="line">	<span class="p">),</span> <span class="k">array</span><span class="p">(</span>
</span><span class="line">		<span class="s1">&#39;style=&quot;font-family:monospace;&quot;&gt;&lt;p&gt;&#39;</span><span class="p">,</span>
</span><span class="line">		<span class="s1">&#39;&lt;/p&gt;&lt;/pre&gt;&#39;</span>
</span><span class="line">	<span class="p">),</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$codeblock</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$codeblock</span><span class="p">)</span> <span class="o">-</span> <span class="mi">7</span><span class="p">));</span>
</span><span class="line">
</span><span class="line">	<span class="c1"># GeSHi 已添加 &lt;pre&gt; 标签</span>
</span><span class="line">	<span class="c1">// $codeblock = &quot;&lt;pre class=\&quot;prettyprint\&quot;&gt;$codeblock\n&lt;/pre&gt;&quot;;</span>
</span><span class="line">
</span><span class="line">	<span class="c1"># 输出测试</span>
</span><span class="line">	<span class="c1">// $fp = fopen(&quot;/Library/Server/Web/Data/Sites/Default/qa/test.txt&quot;, &#39;w&#39;);</span>
</span><span class="line">	<span class="c1">// fwrite($fp, $codeblock);</span>
</span><span class="line">	<span class="c1">// fclose($fp);</span>
</span><span class="line">
</span><span class="line">	<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hashBlock</span><span class="p">(</span><span class="nv">$codeblock</span><span class="p">);</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<ul>
  <li>修改样式代码 <code>wecenter-root/static/css/default/common.css</code>，使超过显示区域长度的代码可横向滚动查看。</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>修改 common.css</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="css"><span class="line"><span class="c">/* 注释掉下面这一行，两个选择器分开写，.wmd-preview pre 不变，.markitup-box pre 的 overflow 属性为 scroll */</span>
</span><span class="line"><span class="c">/*.wmd-preview pre, .markitup-box pre {padding: 16px;line-height: 20px;overflow: hidden; border: none; border-radius: 3px; background-color: #f7f7f7;font-size: 14px;}*/</span>
</span><span class="line"><span class="nc">.wmd-preview</span> <span class="nt">pre</span> <span class="p">{</span><span class="k">padding</span><span class="o">:</span> <span class="m">16px</span><span class="p">;</span><span class="k">line-height</span><span class="o">:</span> <span class="m">20px</span><span class="p">;</span><span class="k">overflow</span><span class="o">:</span> <span class="k">hidden</span><span class="p">;</span> <span class="k">border</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span> <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span> <span class="k">background-color</span><span class="o">:</span> <span class="m">#f7f7f7</span><span class="p">;</span><span class="k">font-size</span><span class="o">:</span> <span class="m">14px</span><span class="p">;}</span>
</span><span class="line"><span class="nc">.markitup-box</span> <span class="nt">pre</span> <span class="p">{</span><span class="k">padding</span><span class="o">:</span> <span class="m">16px</span><span class="p">;</span><span class="k">line-height</span><span class="o">:</span> <span class="m">20px</span><span class="p">;</span><span class="k">overflow</span><span class="o">:</span> <span class="k">scroll</span><span class="p">;</span> <span class="k">border</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span> <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span> <span class="k">background-color</span><span class="o">:</span> <span class="m">#f7f7f7</span><span class="p">;</span><span class="k">font-size</span><span class="o">:</span> <span class="m">14px</span><span class="p">;}</span>
</span><span class="line">
</span><span class="line"><span class="o">...</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="c">/* 末尾添加自定义属性  */</span>
</span><span class="line"><span class="nc">.markitup-box</span> <span class="nt">pre</span> <span class="o">&gt;</span> <span class="nt">p</span> <span class="p">{</span>
</span><span class="line">	<span class="k">display</span><span class="o">:</span> <span class="k">inline</span><span class="o">-</span><span class="k">block</span><span class="p">;</span>
</span><span class="line">	<span class="k">padding</span><span class="o">:</span> <span class="m">0</span> <span class="cp">!important</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<ul>
  <li>在 {{{ 与 }}} 间先输入 {{lang:php}}，表示以下为 PHP 代码（其它格式可参见 <a href="http://qbnz.com/highlighter/">GeSHi 官网</a> 左边栏），然后正常输入代码并显示。</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>输入代码评论</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
</pre></td><td class="code"><pre><code class="robotframework"><span class="line"><span class="c">protected function _doImages_inline_callback($matches) {</span><span class="p"></span>
</span><span class="line"><span class="p">  </span><span class="c">$whole_match = $matches[1];</span><span class="p"></span>
</span><span class="line"><span class="p">  </span><span class="c">$alt_text = $matches[2];</span><span class="p"></span>
</span><span class="line"><span class="p">  </span><span class="c">$url = $matches[3] == &#39;&#39; ? $matches[4] : $matches[3];</span><span class="p"></span>
</span><span class="line"><span class="p">  </span><span class="c">$title = &amp;$matches[7];</span><span class="p"></span>
</span><span class="line">
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="p">  </span><span class="c">$alt_text = $this-&gt;encodeAttribute($alt_text);</span><span class="p"></span>
</span><span class="line"><span class="p">  </span><span class="c">$url = $this-&gt;encodeAttribute($url);</span><span class="p"></span>
</span><span class="line"><span class="p">  </span><span class="c">$result = &quot;&lt;img src=\&quot;$url\&quot; alt=\&quot;$alt_text\&quot;&quot;;</span><span class="p"></span>
</span><span class="line"><span class="p">  </span><span class="c">if (isset($title)) {</span><span class="p"></span>
</span><span class="line"><span class="p">    </span><span class="c">$title = $this-&gt;encodeAttribute($title);</span><span class="p"></span>
</span><span class="line"><span class="p">    </span><span class="c">$result .= &quot; title=\&quot;$title\&quot;&quot;; # $title already quoted</span><span class="p"></span>
</span><span class="line"><span class="p">  </span><span class="c">}</span><span class="p"></span>
</span><span class="line"><span class="p">  </span><span class="c">$result .= $this-&gt;empty_element_suffix;</span><span class="p"></span>
</span><span class="line">
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="p">  </span><span class="c">return $this-&gt;hashPart($result);</span><span class="p"></span>
</span><span class="line"><span class="c">}</span><span class="p"></span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>显示效果如下。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/15.png" class="img-up" title="代码显示效果"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/15.png" width="90%" title="代码显示效果" /></a></p>

<p>注意到我们的代码输入采用两空格缩进，显示起来较美观；想设置 n 空行，在代码输入中应有 n+2 空行。</p>

<p>至此，初步实现了 WeCenter 3.0.2 中的代码高亮功能，剩余工作就是在实践中微调，比如 <strong>Shell 脚本行注释的 # 可能会被 Markdown 解析成标题</strong>，可以自定义转义进行处理，诸如此类。</p>

<h2 id="section-1">参考代码</h2>

<p>附 <a href="http://frank19900731.github.io/downloads/file/Services.rar">参考代码</a>。</p>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/01/26/mac-xia-an-zhuang-wecenter-bing-tian-jia-dai-ma-gao-liang-gong-neng/">http://frank19900731.github.io/blog/2015/01/26/mac-xia-an-zhuang-wecenter-bing-tian-jia-dai-ma-gao-liang-gong-neng/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 Bartender]]></title>
    <link href="http://frank19900731.github.io/blog/2015/01/25/mei-zhou-yi-ruan-zhi-bartender/"/>
    <updated>2015-01-25T23:46:08+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/01/25/mei-zhou-yi-ruan-zhi-bartender</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">功能介绍</h2>

<p><a href="http://www.macbartender.com/">Bartender</a> 是一款菜单栏图标隐藏工具，对于小屏幕 Mac 或菜单栏长期驻留大量图标的俺有很大帮助。</p>

<p>Bartender 运行时也显示在菜单栏中，可设置菜单栏其他图标（既包括系统图标也包括用户软件图标）显示于 Bartender 的子菜单中。</p>

<p>设置界面：</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/16.png" class="img-up" title="设置界面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/16.png" width="80%" title="设置界面" /></a></p>

<p>运行界面：</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/17.png" class="img-up" title="运行界面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/17.png" width="80%" title="运行界面" /></a></p>

<p>对于可能显示通知信息的应用，比如 WeChat，可以设置应用图标在<strong>收到通知时跳出 Bartender 到系统菜单栏中显示一定时间</strong>。</p>

<!-- excerpt end -->

<h2 id="section-1">界面设计</h2>

<p>界面美观。</p>

<p>Bartender 显示在菜单栏中的图标既可以从应用给定的样式中选取，也可以是自定义图片。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/18.png" class="img-up" title="菜单栏图标设置"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/18.png" width="80%" title="菜单栏图标设置" /></a></p>

<h2 id="section-2">易用性</h2>

<p>简单易用。</p>

<h2 id="section-3">稳定性</h2>

<p>稳定性好，未发现过崩溃。</p>

<h2 id="section-4">跨平台</h2>

<p>无。</p>

<h2 id="section-5">类似软件</h2>

<p>类似软件很少，Bartender 本身就很强大了。一款名为 Broomstick 的软件可以指定菜单栏图标隐藏，跟 Bartender 相比逊色多了。</p>

<h2 id="section-6">闪光点</h2>

<ul>
  <li>菜单项隐藏，节省空间。</li>
</ul>

<h2 id="section-7">缺点</h2>

<p>无。</p>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/01/25/mei-zhou-yi-ruan-zhi-bartender/">http://frank19900731.github.io/blog/2015/01/25/mei-zhou-yi-ruan-zhi-bartender/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 Wordify]]></title>
    <link href="http://frank19900731.github.io/blog/2015/01/18/mei-zhou-yi-ruan-zhi-wordify/"/>
    <updated>2015-01-18T15:43:55+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/01/18/mei-zhou-yi-ruan-zhi-wordify</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a>    <ul>
      <li><a href="#section-6">标签云</a></li>
      <li><a href="#section-7">艺术字</a></li>
      <li><a href="#ascii-">ASCII 码字符画</a></li>
    </ul>
  </li>
  <li><a href="#section-8">闪光点</a></li>
  <li><a href="#section-9">缺点</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">功能介绍</h2>

<p><a href="http://www.wordifyapp.com/">Wordify</a> 是一款字符画生成软件。用户选择图片，并可指定或调整</p>

<ul>
  <li>关键词</li>
  <li>单词数目</li>
  <li>单词排布方向（水平、垂直、随机）</li>
  <li>字体、颜色</li>
  <li>输出文件格式</li>
  <li><strong>图像二值化结果</strong></li>
</ul>

<p>最终得到一幅略显酷炫的字符画。</p>

<p><strong>原图</strong>：</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/1.JPG" class="img-up" title="原图"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/1.JPG" width="60%" title="原图" /></a></p>

<!-- excerpt end -->

<p><strong>二值化调整</strong>：</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/8.png" class="img-up" title="二值化调整"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/8.png" width="80%" title="二值化调整" /></a></p>

<p><strong>字符画结果</strong>：</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/9.png" class="img-up" title="字符画生成结果"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/9.png" width="90%" title="字符画生成结果" /></a></p>

<p>生成效果是随机的，可多次调整取最佳；单词重复设置相当于提高相应单词的权重。</p>

<h2 id="section-1">界面设计</h2>

<p>美观清爽。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/10.png" class="img-up" title="Wordify 界面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/10.png" width="80%" title="Wordify 界面" /></a></p>

<h2 id="section-2">易用性</h2>

<p>简洁易用。</p>

<h2 id="section-3">稳定性</h2>

<p>运行稳定。</p>

<h2 id="section-4">跨平台</h2>

<p>支持 iOS。</p>

<h2 id="section-5">类似软件</h2>

<p>字符画并不止 Wordify 生成的这种样式，其它相关工具介绍如下。</p>

<h3 id="section-6">标签云</h3>

<ul>
  <li><a href="http://www.jasondavies.com/wordcloud/#%2F%2Fwww.jasondavies.com%2Fwordtree%2Fcat-in-the-hat.txt">D3</a> </li>
  <li><a href="http://115.28.18.88/keywordExtractDemo">清语</a></li>
  <li>WordPack，一款 iOS 应用</li>
</ul>

<p><strong>D3 Word Cloud</strong></p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/11.png" class="img-up" title="D3 Word Cloud"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/11.png" width="80%" title="D3 Word Cloud" /></a></p>

<h3 id="section-7">艺术字</h3>

<ul>
  <li><a href="http://www.figlet.org/">figlet</a>，a program for making large letters out of ordinary text</li>
  <li><a href="https://github.com/viisual/ASCII-Decorator">ASCII-Decorator</a>， 基于 figlet 的 Sublime 插件</li>
</ul>

<p><strong>Figlet 效果</strong></p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/12.png" class="img-up" title="Figlet 效果"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/12.png" width="80%" title="Figlet 效果" /></a></p>

<h3 id="ascii-">ASCII 码字符画</h3>

<ul>
  <li>Mac 应用
    <ul>
      <li><a href="http://www.jave.de/">Jave</a>，Java Ascii Versatile Editor，原始而古老，用起来费劲……</li>
      <li><a href="http://monodraw.helftone.com/">Monodraw</a>，Powerful ASCII art editor，开发中，<strong>未开放下载</strong></li>
      <li><a href="https://itunes.apple.com/us/app/sweetie/id547106404?mt=12">Sweetie</a>，算是可用软件中功能较全、效果较好的一个，见下图</li>
    </ul>
  </li>
  <li>iOS 应用
    <ul>
      <li>Image2Ascii</li>
    </ul>
  </li>
  <li>在线转换
    <ul>
      <li><a href="http://www.typorganism.com/asciiomatic/">1</a>，要求 JPEG 格式，尺寸是 60*50</li>
      <li><a href="http://www.degraeve.com/img2txt.php">2</a></li>
      <li><a href="http://life.chacuo.net/convertphoto2char">3</a></li>
    </ul>
  </li>
  <li>编程实现
    <ul>
      <li><a href="http://everet.org/python-ascii-art.html">Python 生成字符画</a></li>
      <li><a href="http://www.zoneky.com/blog/2014/07/10/ASCII-Art-algorithms/">Javascript 生成字符画</a></li>
    </ul>
  </li>
</ul>

<p><strong>Sweetie 效果</strong></p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/13.png" class="img-up" title="Sweetie 效果"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/13.png" width="80%" title="Sweetie 效果" /></a></p>

<p><strong>Image2Ascii 效果</strong></p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/14.png" class="img-up" title="Image2Ascii 效果"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/14.png" width="70%" title="Image2Ascii 效果" /></a></p>

<h2 id="section-8">闪光点</h2>

<p>定制较丰富，界面与生成的图片都很美观。</p>

<h2 id="section-9">缺点</h2>

<p>想得到一幅满意的字符画需要反复尝试，希望有更细致的交互式调整。</p>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/01/18/mei-zhou-yi-ruan-zhi-wordify/">http://frank19900731.github.io/blog/2015/01/18/mei-zhou-yi-ruan-zhi-wordify/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 XnConvert]]></title>
    <link href="http://frank19900731.github.io/blog/2015/01/11/mei-zhou-yi-ruan-zhi-xnconvert/"/>
    <updated>2015-01-11T22:32:29+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/01/11/mei-zhou-yi-ruan-zhi-xnconvert</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<h2 id="section">功能介绍</h2>

<p><a href="http://www.xnview.com/en/xnconvert/">XnConvert</a> 是一个跨平台的图片批处理工具，提供 resize、crop、rotate、高斯模糊等在内的 80 多种图像操作，支持 <a href="http://www.xnview.com/en/xnconvert/#formats">500 余种图像格式</a>的读入、70 余种图像格式生成，可以定制输出图片的命名格式。XnConvert 比较适合照片整理（重命名、加水印等）、网页图片素材准备（图片放缩、加图像掩模、模糊等）等批处理任务。</p>

<p>XnConvert 以<strong>工作流</strong>的方式定制图片的处理过程，使用起来非常简单。</p>

<p>首先确定选择输入图片或图片文件夹。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/5.png" class="img-up" title="输入图片"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/5.png" width="80%" title="输入图片" /></a></p>

<p>然后在图片上定义操作行为和参数。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/6.png" class="img-up" title="操作行为和参数"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/6.png" width="80%" title="操作行为和参数" /></a></p>

<p>上图顺序定义了三种行为，<strong>核大小为 13*13 的高斯模糊</strong>，<strong>垂直翻转</strong>，<strong>长宽减半</strong>。Resize 中还有一些参数可调，比如填充模式（fit 或 fill 或 longest side 或 shortest side 等）和降采样方法（Bilinear、BSpline、Lanczos 等）。</p>

<p>最后定义输出文件夹、输出文件格式和命名方式。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/7.png" class="img-up" title="输出文件夹和命名方式"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/7.png" width="80%" title="输出文件夹和命名方式" /></a></p>

<p>除输出到文件夹，还可以传给 Email 或 Zip 等。</p>

<p>命名方式支持格式化表达，比如  <code>{Filename}_{Current Date [m_d_Y]}</code>。</p>

<!-- excerpt end -->

<p>XnConvert 的工作流有两种保存方式，一种是后缀名为 xbs 的 XML 格式文件，可以被 XnConvert 重新载入。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>xbs 文件示例</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="xml"><span class="line"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="nt">&lt;XnView_script</span> <span class="na">version=</span><span class="s">&quot;1.0&quot;</span> <span class="na">name=</span><span class="s">&quot;a&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="nt">&lt;Gaussian_blur</span> <span class="na">size=</span><span class="s">&quot;13&quot;</span><span class="nt">/&gt;</span>
</span><span class="line">    <span class="nt">&lt;Mirror</span> <span class="na">method=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
</span><span class="line">    <span class="nt">&lt;Resize</span> <span class="na">mode=</span><span class="s">&quot;4&quot;</span> <span class="na">width=</span><span class="s">&quot;50&quot;</span> <span class="na">height=</span><span class="s">&quot;50&quot;</span> <span class="na">unit=</span><span class="s">&quot;1&quot;</span> <span class="na">ratio=</span><span class="s">&quot;true&quot;</span> <span class="na">orientation=</span><span class="s">&quot;false&quot;</span> <span class="na">enlarge=</span><span class="s">&quot;0&quot;</span> <span class="na">resample=</span><span class="s">&quot;7&quot;</span> <span class="na">gamma_correct=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
</span><span class="line">    <span class="nt">&lt;Output</span> <span class="na">folder=</span><span class="s">&quot;/Users/frank/Desktop/&quot;</span> <span class="na">filename=</span><span class="s">&quot;modified&quot;</span> <span class="na">case=</span><span class="s">&quot;0&quot;</span> <span class="na">format=</span><span class="s">&quot;JPEG&quot;</span><span class="nt">&gt;</span>
</span><span class="line">        <span class="nt">&lt;Options</span> <span class="na">overwrite=</span><span class="s">&quot;1&quot;</span> <span class="na">orgDate=</span><span class="s">&quot;false&quot;</span> <span class="na">keepMeta=</span><span class="s">&quot;true&quot;</span> <span class="na">keepICC=</span><span class="s">&quot;false&quot;</span> <span class="na">keepFolder=</span><span class="s">&quot;false&quot;</span> <span class="na">delOrg=</span><span class="s">&quot;false&quot;</span> <span class="na">multipage=</span><span class="s">&quot;false&quot;</span> <span class="na">allPages=</span><span class="s">&quot;false&quot;</span> <span class="na">openExplorer=</span><span class="s">&quot;false&quot;</span> <span class="na">openBrowser=</span><span class="s">&quot;false&quot;</span> <span class="na">clearItems=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
</span><span class="line">        <span class="nt">&lt;JPEG</span> <span class="na">quality=</span><span class="s">&quot;80&quot;</span> <span class="na">progressive=</span><span class="s">&quot;false&quot;</span> <span class="na">optimizeHuffman=</span><span class="s">&quot;false&quot;</span> <span class="na">rebuildThumb=</span><span class="s">&quot;true&quot;</span> <span class="na">orgQuality=</span><span class="s">&quot;false&quot;</span> <span class="na">DCTMethod=</span><span class="s">&quot;0&quot;</span> <span class="na">subSampling=</span><span class="s">&quot;0&quot;</span> <span class="na">smoothFactor=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
</span><span class="line">    <span class="nt">&lt;/Output&gt;</span>
</span><span class="line"><span class="nt">&lt;/XnView_script&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>另一种是导出为命令行，可以用 <a href="http://www.xnview.com/en/nconvert/">nconvert</a> 执行。nconvert 是免费的命令行工具，XnConvert 只是它的可视化壳子。<code>nconvert -help</code> 显示支持的 80 种操作和众多图片文件格式。</p>

<p>以之前定义的工作流为例，导出如下命令行。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>nconvert 命令示例</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">nconvert -gauss 13 -yflip -ratio -rtype lanczos -resize 50% 50%
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-1">界面设计</h2>

<p>实用无美感。</p>

<h2 id="section-2">易用性</h2>

<p>简单直接，非常易用。</p>

<h2 id="section-3">稳定性</h2>

<p>稳定，不会因文件数量大而崩溃。</p>

<h2 id="section-4">跨平台</h2>

<p>Windows、Mac、Linux 通用。</p>

<h2 id="section-5">类似软件</h2>

<p><code>Photoshop</code>、<code>Acorn</code> 等图片处理软件功能强大，门槛相应也高，消耗资源多。<code>Photoshop</code> 支持<strong>动作录制批处理</strong>。</p>

<p><code>Image Smith</code> 也是一款比较全能的图片批处理软件，但经验是使用中容易崩溃；<code>PhotoResize Pro</code> 功能较少，主要是图片大小调整和重命名。 </p>

<p>Matlab、Python、R 等编程语言都能找到自己的图片处理工具箱（自带或者开源的），有一定的学习成本，需要可视化界面的话得自己编写。</p>

<p><code>Automator</code> 支持一些图片操作，可以编写工作流。</p>

<p>Mac 自带 <code>sips</code> 命令支持一些图片操作，其它图片处理相关的命令行或包应该还有不少，就不继续查找列举了。</p>

<h2 id="section-6">闪光点</h2>

<ul>
  <li>提供命令行工具，方便嵌入到程序中使用；</li>
  <li>工作流操作模式，可保存重用。</li>
</ul>

<h2 id="section-7">缺点</h2>

<ul>
  <li>软件界面简陋；</li>
  <li>命令行工具不开源。</li>
</ul>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/01/11/mei-zhou-yi-ruan-zhi-xnconvert/">http://frank19900731.github.io/blog/2015/01/11/mei-zhou-yi-ruan-zhi-xnconvert/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用 Webhook 在 Gitlab 中实现类 Github Pages 效果]]></title>
    <link href="http://frank19900731.github.io/blog/2015/01/10/shi-yong-webhook-zai-gitlab-zhong-shi-xian-lei-github-pages-xiao-guo/"/>
    <updated>2015-01-10T21:35:56+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/01/10/shi-yong-webhook-zai-gitlab-zhong-shi-xian-lei-github-pages-xiao-guo</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#gitlab">Gitlab</a></li>
  <li><a href="#web-hooks">Web hooks</a></li>
  <li><a href="#section">操作步骤</a>    <ul>
      <li><a href="#project">创建 Project，提交代码</a></li>
      <li><a href="#web-hooks-1">关联 Web hooks</a></li>
      <li><a href="#web-hooks-">Web hooks 逻辑</a></li>
    </ul>
  </li>
</ul>

<!-- excerpt start -->

<h2 id="gitlab">Gitlab</h2>

<p><a href="https://gitlab.com/gitlab-org/gitlab-ce/tree/master">Gitlab</a> 是一个与 Github 极为相似的可视化版本管理系统，它基于 Git、Ruby on Rails、Redis 等工具框架，目前支持 Ubuntu、Debian、CentOS 在内的部分 *inx 操作系统，<strong>不考虑支持 Windows</strong>，详见 <a href="https://gitlab.com/gitlab-org/gitlab-ce/blob/master/doc/install/requirements.md">Requirements</a>。Gitlab 既有收费企业版，也有免费开源社区版本，被超过十万家机构广泛应用，安装方法及相关文档可以在 <a href="http://doc.gitlab.com/ce/">这里</a> 找到。</p>

<p>最简单的安装方式是下载 Omnibus 安装包进行安装，在 <a href="https://about.gitlab.com/downloads/">这里</a> 根据系统下载安装包，安装方法是</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Gitlab Omnibus Package 安装</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="c"># Ubuntu/Debian:</span>
</span><span class="line">sudo dpkg -i gitlab_x.x.x-omnibus.xxx.deb
</span><span class="line">
</span><span class="line"><span class="c"># CentOS:</span>
</span><span class="line">sudo rpm -Uvh gitlab-x.x.x_xxx.rpm
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>系统初始登录账号是 <code>root</code>，密码是 <code>5iveL!fe</code>，登录后修改密码，为自己创建用户（组）。</p>

<p>Gitlab 的基本使用体验和 Github 是无差的，不过并不提供 <a href="https://pages.github.com/">Github Pages</a> 的功能：</p>

<blockquote>
  <p>Hosted directly from your GitHub repository. Just edit, push, and your changes are live.</p>
</blockquote>

<p>其实 Github Pages 的最大吸引力是<strong>免费的空间</strong>和<strong>免除服务器设置</strong>，如果单纯要实现 <code>Just edit, push, and your changes are live</code> 这一功能，可以借助 Web hooks。</p>

<!-- excerpt end -->

<h2 id="web-hooks">Web hooks</h2>

<p>Gitlab 中 Web hooks 的概念当然也和 Github 没差，给予的解释是</p>

<blockquote>
  <p>Project web hooks allow you to trigger an URL if new code is pushed or a new issue is created.</p>

  <p>You can configure web hooks to listen for specific events like pushes, issues or merge requests. GitLab will send a POST request with data to the web hook URL.</p>

  <p>Web hooks can be used to update an external issue tracker, trigger CI builds, update a backup mirror, or even deploy to your production server.</p>
</blockquote>

<p>我们想要实现的是让 push events 触发 production server 上的内容更新，更具体的说，是让我 <strong>Octopress 博客的 master 分支的 push 操作</strong>，触发<strong>网页服务器的内容更新</strong>。</p>

<p>push 操作发送的 post 请求内容示例如下。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>push 操作的 post 请求示例</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
</pre></td><td class="code"><pre><code class="json"><span class="line"><span class="p">{</span>
</span><span class="line">  <span class="nt">&quot;before&quot;</span><span class="p">:</span> <span class="s2">&quot;95790bf891e76fee5e1747ab589903a6a1f80f22&quot;</span><span class="p">,</span>
</span><span class="line">  <span class="nt">&quot;after&quot;</span><span class="p">:</span> <span class="s2">&quot;da1560886d4f094c3e6c9ef40349f7d38b5d27d7&quot;</span><span class="p">,</span>
</span><span class="line">  <span class="nt">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;refs/heads/master&quot;</span><span class="p">,</span>
</span><span class="line">  <span class="nt">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span class="line">  <span class="nt">&quot;user_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Smith&quot;</span><span class="p">,</span>
</span><span class="line">  <span class="nt">&quot;project_id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
</span><span class="line">  <span class="nt">&quot;repository&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="line">    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Diaspora&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;git@example.com:diaspora.git&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="nt">&quot;homepage&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/diaspora&quot;</span>
</span><span class="line">  <span class="p">},</span>
</span><span class="line">  <span class="nt">&quot;commits&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;b6568db1bc1dcd7f8b4d5a946b0b91f9dacd7327&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Update Catalan translation to e38cb41.&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2011-12-12T14:27:31+02:00&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/diaspora/commits/b6568db1bc1dcd7f8b4d5a946b0b91f9dacd7327&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="nt">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="line">        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Jordi Mallach&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="nt">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;jordi@softcatala.org&quot;</span>
</span><span class="line">      <span class="p">}</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;da1560886d4f094c3e6c9ef40349f7d38b5d27d7&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;fixed readme&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2012-01-03T23:36:29+02:00&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/diaspora/commits/da1560886d4f094c3e6c9ef40349f7d38b5d27d7&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="nt">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="line">        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;GitLab dev user&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="nt">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;gitlabdev@dv6700.(none)&quot;</span>
</span><span class="line">      <span class="p">}</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">],</span>
</span><span class="line">  <span class="nt">&quot;total_commits_count&quot;</span><span class="p">:</span> <span class="mi">4</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>我们只需要关注 <code>ref: refs/heads/master</code>，保证是 <strong>master</strong> 分支的 push 操作，而非其它分支（比如 source）。</p>

<p>官方提供了一个 ruby 版本的 webhook 接收逻辑。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>print_http_body.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="nb">require</span> <span class="s1">&#39;webrick&#39;</span>
</span><span class="line">
</span><span class="line"><span class="n">server</span> <span class="o">=</span> <span class="ss">WEBrick</span><span class="p">:</span><span class="ss">:HTTPServer</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:Port</span> <span class="o">=&gt;</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
</span><span class="line"><span class="n">server</span><span class="o">.</span><span class="n">mount_proc</span> <span class="s1">&#39;/&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="o">|</span>
</span><span class="line">  <span class="nb">puts</span> <span class="n">req</span><span class="o">.</span><span class="n">body</span>
</span><span class="line"><span class="k">end</span>
</span><span class="line">
</span><span class="line"><span class="nb">trap</span> <span class="s1">&#39;INT&#39;</span> <span class="k">do</span>
</span><span class="line">  <span class="n">server</span><span class="o">.</span><span class="n">shutdown</span>
</span><span class="line"><span class="k">end</span>
</span><span class="line"><span class="n">server</span><span class="o">.</span><span class="n">start</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>运行 <code>ruby print_http_body.rb 8000</code> 即可监听 push 事件。</p>

<p>我的打算是在自己现有的 Apache 服务器上，用 PHP 写这个简单逻辑。</p>

<h2 id="section">操作步骤</h2>

<p>将 Github 上的 Octorpess 博客迁移到 Gitlab 上的步骤如下。</p>

<h3 id="project">创建 Project，提交代码</h3>

<p>在 Gitlab 中创建 Project，在本地 Octopress Repository 文件夹下执行</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>添加 Gitlab 远端版本库</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">git remote add gitlab http://example.com/username/octopress.git
</span><span class="line">git push -u gitlab <span class="nb">source</span>:source
</span><span class="line">
</span><span class="line"><span class="nb">cd </span>_deploy
</span><span class="line">git remote add gitlab http://example.com/username/octopress.git
</span><span class="line">git push -u gitlab master:master
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>gitlab 是自定义远端版本库的名称，以后可以向 Github 和自己搭建的 Gitlab 分别提交 master、source 分支的更改。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>向 Github、Gitlab 提交更改</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="c"># github</span>
</span><span class="line">rake deploy
</span><span class="line">git push origin <span class="nb">source</span>
</span><span class="line">
</span><span class="line"><span class="c"># gitlab</span>
</span><span class="line"><span class="nb">cd </span>_deploy
</span><span class="line">git push gitlab master
</span><span class="line"><span class="nb">cd</span> ..
</span><span class="line">git push gitlab <span class="nb">source</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>我们希望 <code>git push gitlab master</code> 触发服务器内容更新。</p>

<h3 id="web-hooks-1">关联 Web hooks</h3>

<p>如下图进入 Settings -&gt; Webhooks 创建一个钩子</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/4.png" class="img-up" title="钩子创建"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/4.png" width="90%" title="钩子创建" /></a></p>

<p>点击 <code>Test Hook</code> 发送模拟消息到你指定的 URL。</p>

<h3 id="web-hooks-">Web hooks 逻辑</h3>

<p>编写 PHP 脚本如下</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Web hooks 逻辑</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class="line">
</span><span class="line">    <span class="nv">$de_json</span> <span class="o">=</span>  <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;HTTP_RAW_POST_DATA&#39;</span><span class="p">],</span> <span class="k">TRUE</span><span class="p">);</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="nv">$de_json</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;refs/heads/master&quot;</span><span class="p">)</span> <span class="c1">// pull only when master branch updated</span>
</span><span class="line">        <span class="nb">shell_exec</span><span class="p">(</span><span class="s2">&quot;cd /path/to/your/webcontent;/usr/bin/git pull http://example.com/username/octopress.git&quot;</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>识别是 master 分支的更新提交，就到网页目录下更新内容。</p>

<p>测试中发现 PHP 里嵌入的 shell 命令无法执行，而在命令行中可以执行。网上查询可能是 safe_mode 设置的问题或者 <code>shell_exec</code> 在设置中被 disable 掉，又或者是 shell 执行环境的问题，不过最后确认的原因还是<strong>权限问题</strong>。</p>

<p>我把 Octopress 的内容放在 lighttpd 中，而 PHP 的运行环境是 Apache，后者的实际运行用户是 <code>www-data</code>（在 PHP 代码中执行 <code>whoami</code> 可知），而非登录用户或者 <code>root</code>，所以要改变 <code>www-data</code> 对于目录或文件的权限。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>权限变更</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">chmod o+rwx /usr/bin/git
</span><span class="line">chmod -R o+rwx /path/to/your/webcontent
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>让 <code>www-data</code> 有权限执行 git 命令，并操作网页内容文件夹。</p>

<p>到这里，已经将 Octopress 迁移到 Gitlab 上，并完成 修改 -&gt; 提交 -&gt; 自动更新的功能。</p>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/01/10/shi-yong-webhook-zai-gitlab-zhong-shi-xian-lei-github-pages-xiao-guo/">http://frank19900731.github.io/blog/2015/01/10/shi-yong-webhook-zai-gitlab-zhong-shi-xian-lei-github-pages-xiao-guo/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[每周一软之 Sapiens]]></title>
    <link href="http://frank19900731.github.io/blog/2015/01/04/mei-zhou-ruan-zhi-sapiens/"/>
    <updated>2015-01-04T00:37:59+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/01/04/mei-zhou-ruan-zhi-sapiens</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#section">功能介绍</a></li>
  <li><a href="#section-1">界面设计</a></li>
  <li><a href="#section-2">易用性</a></li>
  <li><a href="#section-3">稳定性</a></li>
  <li><a href="#section-4">跨平台</a></li>
  <li><a href="#section-5">类似软件</a></li>
  <li><a href="#section-6">闪光点</a></li>
  <li><a href="#section-7">缺点</a></li>
</ul>

<!-- excerpt start -->

<p>在这么一个<strong>读图时代</strong>、<strong>看脸时代</strong>，软件的颜值也称得上一个重要的衡量指标。Sapien 除了有一张美丽的面孔，还有那么点小情趣，挺讨人喜欢的。</p>

<h2 id="section">功能介绍</h2>

<p>Sapiens 是一个软件快速启动工具，且目前只支持软件快速打开，没有打开文件、执行脚本啦什么旁的功能。</p>

<p>Sapiens 除了通常的快捷键启动方式，还有<strong>画圈圈</strong>启动方式，具体见如下动态图。从动态图还可以看出它默认<strong>列举你最近用过的软件</strong>。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/1.gif" class="img-up" title="动态图"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/1.gif" width="70%" title="动态图" /></a></p>

<blockquote><p>兰花指微翘，食指指尖在触摸板上看似不经意的划出那一弯圆月，美美的界面就映入眼帘，真真儿的是让人陶醉呢……</p></blockquote>

<p><strong>转向顺时针、逆时针皆可</strong>，圈数触发可以设置在 1 - 3 圈，默认是 1.4 圈。经测试设置为 1 圈的时候，大概也就是<strong>一圈半</strong>能识别出的水平。注意<strong>手速稍快些</strong>，<strong>画的圆半径不要太小</strong>，试过几次就能很熟练了。</p>

<!-- excerpt end -->

<p>既漂亮又有情趣，倘若是无脑，那也就是平平啦，不过人家可是结合了人工智能的呦。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/3.png" class="img-up" title="Artificial Inteligence"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/3.png" width="70%" title="Artificial Inteligence" /></a></p>

<p>把 <strong>About Sapiens’ Artificial Intelligence</strong> 那抄录下来。</p>

<blockquote><p>Sapiens tries to predict the applications you will want to launch.</p><p>Sapiens understands what applications you use and learns how you interact with your Mac. For this reason it may take 2-3 days (it really depends how often you use your mac daily) for it to have enough brain power for making accurate predictions.</p><p>Also, as your habits change Sapiens keeps adapting to them by constantly learning from you.</p></blockquote>

<p>就是说，你把人家来安装，我来把你细观察，你想吃饭我端碗，你想拉屎我递纸，把你伺候好好的，一辈子都随你意。</p>

<h2 id="section-1">界面设计</h2>

<p>提供五种布局，默认的如下图。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/2.png" class="img-up" title="Sapiens 图示"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/2.png" width="70%" title="Sapiens 图示" /></a></p>

<p>可以设置 <strong>Desktop Mirroring Effect</strong>，圆内背景就是桌面背景加了遮罩的效果，配合上<strong>动态壁纸</strong>，确实八错。</p>

<h2 id="section-2">易用性</h2>

<p>傻瓜软件。</p>

<h2 id="section-3">稳定性</h2>

<p>稳定，未遇异常。</p>

<h2 id="section-4">跨平台</h2>

<p>无。</p>

<h2 id="section-5">类似软件</h2>

<p>提到快速启动软件，那头两把交椅自然就是 <a href="http://www.alfredapp.com/">Alfred</a> 和 <a href="http://qsapp.com/">QuickSilver</a> ，前者闭源收费（确切的说是高级功能收费），后者开源免费。</p>

<p>二者都有很强的附加功能，比如文件搜索、删除、压缩、查看详情啦，脚本执行、iTunes 控制啦等。关于它们的对比网上有 <a href="http://www.v2ex.com/t/42050">很多讨论</a>，不在这里多说。 </p>

<p>QuickSilver 有自己的插件列表，因为是开源的，所以也可以自己开发，不过门槛应该比较高吧？Alfred 有一个 Workflow 模式，是收费功能，可以通过撰写脚本、连接模块实现自己想要的功能，就相当于一个插件定制系统了（有点类似于 Automator），适合于普通程序员。</p>

<p>本人最早使用的是 QucikSilver，习惯积累下来也就没有转到 Alfred，也是因为前者已经能够满足所需。最近尝试用用 Alfred，也别落伍太多，先从这个 <a href="https://github.com/hzlzh/AlfredWorkflow.com">Workflow 列表</a> 看起吧，这个 <a href="http://lucifr.com/2011/11/30/alfred-and-some-recommanded-extensions/">博客</a> 中也有很多 Alfred 相关内容。</p>

<p>不过我还是有点想不明白为什么要把那么多功能都堆到这个小软件里，自动和手动差别就这么大么，还是说在追求些别的什么。</p>

<p>最主要的原因是我还不够 Geek 吧……</p>

<h2 id="section-6">闪光点</h2>

<p>漂亮。</p>

<h2 id="section-7">缺点</h2>

<p>既然漂亮，就别要求那么高了。</p>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/01/04/mei-zhou-ruan-zhi-sapiens/">http://frank19900731.github.io/blog/2015/01/04/mei-zhou-ruan-zhi-sapiens/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Gollum 开机启动配置]]></title>
    <link href="http://frank19900731.github.io/blog/2015/01/02/gollum-kai-ji-qi-dong-pei-zhi/"/>
    <updated>2015-01-02T09:31:32+08:00</updated>
    <id>http://frank19900731.github.io/blog/2015/01/02/gollum-kai-ji-qi-dong-pei-zhi</id>
    <content type="html"><![CDATA[<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#gollum-">Gollum 介绍</a></li>
  <li><a href="#section">安装</a></li>
  <li><a href="#section-1">配置</a>    <ul>
      <li><a href="#section-2">编码错误</a></li>
      <li><a href="#mathjax">配置本地 MathJax</a></li>
      <li><a href="#section-3">微调界面</a></li>
      <li><a href="#js-">嵌入 JS 代码</a></li>
    </ul>
  </li>
  <li><a href="#section-4">开机启动</a></li>
  <li><a href="#section-5">总结</a></li>
</ul>

<!-- excerpt start -->

<h2 id="gollum-">Gollum 介绍</h2>

<p><a href="https://github.com/gollum/gollum">Gollum</a> 是一个轻量级的 Wiki 框架，可以管理以 Git Repository 形式存在的文件夹。相比于 Mediawiki，文档迁移性更灵活，界面也清新美观。支持多种文档格式，包括 Markdown、MediaWiki、Org-mode、Plain Text、reStructuredText、RDoc、Textile 等。</p>

<p><a href="http://frank19900731.github.io/img/post/2015-1/1.png" class="img-up" title="Gollum 界面"><img class="imgcenter" src="http://frank19900731.github.io/img/post/2015-1/1.png" width="90%" title="Gollum 界面" /></a></p>

<p>Gollum 自带公式输入支持，可自定义 MathJax 的配置；<strong>支持图片拖拽插入</strong>（并自动上传），这是让我觉得很方便的一点。美中不足的是，Gollum 不支持中文命名的文件，所以</p>

<ul>
  <li>如果 Git Repository 中包含中文命名文档，则无法正确显示；</li>
  <li>对于中文名称链接，Gollum 会将该名称<strong>转为拼音形式作为文件名</strong>，相应链接、文档标题也都是拼音；</li>
  <li>如果上传图片是中文命名的，也无法正确显示。</li>
</ul>

<h2 id="section">安装</h2>

<p>按照 <a href="https://github.com/gollum/gollum#installation">说明</a> 安装即可。</p>

<p>Gollum 安装过程可能会比较慢，或者报 TIME_OUT 错误，可切换至 <a href="http://ruby.taobao.org/">淘宝镜像</a>。</p>

<!-- excerpt end -->

<h2 id="section-1">配置</h2>

<h3 id="section-2">编码错误</h3>

<p>编辑文档过程中，特别是使用非 Gollum 网页编辑器编辑文档<strong>并提交</strong>，可能会出现 <code>incompatible character encodings: UTF-8 and ASCII-8BIT</code> 编码错误，需要 <a href="https://github.com/gollum/gollum/issues/843">修改 gitlab-grit 中的 index.rb 代码的第 176 行</a> 如下</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Gollum Encoding Fix</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">tree_contents</span><span class="o">[</span><span class="n">k</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;%s %s</span><span class="se">\0</span><span class="s2">%s&quot;</span> <span class="o">%</span> <span class="o">[</span><span class="n">tmode</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">force_encoding</span><span class="p">(</span><span class="s1">&#39;ASCII-8BIT&#39;</span><span class="p">),</span> <span class="n">sha</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>也就是加入了强制编码。</p>

<p>gitlab-grit 的路径，如果使用 rvm 的 ruby 安装，是 </p>

<p><code>/Users/frank/.rvm/rubies/ruby-X.X.X/lib/ruby/gems/X.X.X/gems/gitlab-grit/lib/grit/index.rb</code></p>

<p>如果使用系统 ruby 安装，则是</p>

<p><code>/Library/Ruby/Gems/X.X.X/gems/gitlab-grit/lib/grit/index.rb</code> 。</p>

<h3 id="mathjax">配置本地 MathJax</h3>

<p>因为可能离线查看文档，所以最好将 MathJax 的请求引到本地，下载 <a href="https://github.com/mathjax/MathJax">MathJax</a> 到本地服务器即可，然后修改 Gollum 模板定义。</p>

<p>同上述，文件路径是</p>

<p><code>/Users/frank/.rvm/rubies/ruby-X.X.X/lib/ruby/gems/X.X.X/gems/gollum/lib/gollum/templates/layout.mustache</code></p>

<p>或</p>

<p><code>/Library/Ruby/Gems/X.X.X/gems/gollum/lib/gollum/templates/layout.mustache</code> 。</p>

<p>第 54 行修改为</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>MathJax 请求修改</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">j</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">&#39;//localhost/MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML&#39;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h3 id="section-3">微调界面</h3>

<p>Gollum 的界面定制起来很方便，修改 gollum.css 或者 -&#45;css 参数指定都可以。</p>

<p>gollum.css 的路径是</p>

<p><code>/Users/frank/.rvm/rubies/ruby-X.X.X/lib/ruby/gems/X.X.X/gems/gollum/lib/gollum/public/gollum/css/gollum.css</code></p>

<p>或</p>

<p><code>/Library/Ruby/Gems/X.X.X/gems/gollum/lib/gollum/public/gollum/css/gollum.css</code> 。</p>

<p>标题是 h1 、左浮动，菜单是 ul、右浮动。当标题较长时，二者配合搭配不好看，修改为</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>标题样式修改</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="css"><span class="line"><span class="nf">#head</span> <span class="nt">h1</span> <span class="p">{</span>
</span><span class="line">  <span class="k">font-size</span><span class="o">:</span> <span class="m">1.5em</span><span class="p">;</span>
</span><span class="line">  <span class="c">/* float: left; */</span>
</span><span class="line">  <span class="k">line-height</span><span class="o">:</span> <span class="k">normal</span><span class="p">;</span>
</span><span class="line">  <span class="c">/* margin: 0; */</span>
</span><span class="line">  <span class="k">margin-bottom</span><span class="o">:</span> <span class="m">20px</span><span class="p">;</span>
</span><span class="line">  <span class="k">padding</span><span class="o">:</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0.667em</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>现在我们改用 custom.css 做两处定制</p>

<ul>
  <li>二级列表与一级列表项目上下边缘的长度太大，因为默认样式只定义了 <code>ul</code>，没有考虑二级列表的情况，我们希望<strong>多级列表的行是等间距的</strong>；</li>
  <li>表格内容（<code>tbody</code>）没有扩展到整个表格（<code>table</code>）区域，视觉效果是表格偏向页面左侧，我们希望<strong>表格居中、内容充满</strong>。</li>
</ul>

<p>在 Git Repository 的根目录下创建 custom.css，编辑内容为</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>二级列表与表格居中定制</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</pre></td><td class="code"><pre><code class="css"><span class="line"><span class="nt">li</span> <span class="o">&gt;</span> <span class="nt">ul</span> <span class="p">{</span>
</span><span class="line">  <span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="cp">!important</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nc">.center90</span> <span class="p">{</span>
</span><span class="line">	<span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="k">auto</span> <span class="cp">!important</span><span class="p">;</span>
</span><span class="line">	<span class="k">width</span><span class="o">:</span> <span class="m">90</span><span class="o">%</span><span class="p">;</span>
</span><span class="line">	<span class="k">display</span><span class="o">:</span> <span class="n">table</span> <span class="cp">!important</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nc">.center80</span> <span class="p">{</span>
</span><span class="line">	<span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="k">auto</span> <span class="cp">!important</span><span class="p">;</span>
</span><span class="line">	<span class="k">width</span><span class="o">:</span> <span class="m">80</span><span class="o">%</span><span class="p">;</span>
</span><span class="line">	<span class="k">display</span><span class="o">:</span> <span class="n">table</span> <span class="cp">!important</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><code>center90</code> 表示表格宽度占父元素 90% 且居中显示，表格内容充满此区域。</p>

<p>保存 custom.css，此时还看不到正确显示，需要 <code>git commit</code> 后查看。</p>

<p>关于表格还要多说一句，如果想实现单元格的<strong>多列/行合并</strong>（columnspan/rowspan），Markdown 是做不到的，可以写 Html 代码，或者改用 MediaWiki 格式的文档。推荐一个 <a href="http://www.tablesgenerator.com/">在线表格生成器</a>（貌似在墙外），支持 Latex、HTML、Plain Text、Markdown、MediaWiki 格式的表格生成，也可参考 <a href="http://pub.lcair.com/index.php?title=MediaWiki%E8%AF%AD%E6%B3%95">MediaWiki 的语法</a>。</p>

<p>那么问题来了，如何将表格的类定义为 <code>center90</code> 、<code>center80</code> ？</p>

<p>MediaWiki 支持直接设置，而 Gollum 使用的 Markdown 编译器则不支持类的设定（本博客使用的 kramdown 是可以的）。一个简单的想法是使用内嵌 JS 代码进行设置，然而由于 Gollum 使用了 <a href="https://github.com/gollum/gollum/blob/master/docs/sanitization.md">Sanitization Rules</a>（相关代码在 <a href="https://github.com/gollum/gollum-lib">gollum-lib</a> 中），所以还是需要一番设置的，见下节介绍。</p>

<h3 id="js-">嵌入 JS 代码</h3>

<p>还是在根目录下，创建 config.rb，编辑内容为</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>让 Gollum 支持 script 标签和 src 属性</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">sanitizer</span> <span class="o">=</span> <span class="ss">Gollum</span><span class="p">:</span><span class="ss">:Sanitization</span><span class="o">.</span><span class="n">new</span>
</span><span class="line"><span class="n">sanitizer</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">concat</span> <span class="o">[</span><span class="s1">&#39;script&#39;</span><span class="o">]</span> <span class="c1"># Tags</span>
</span><span class="line"><span class="n">sanitizer</span><span class="o">.</span><span class="n">attributes</span><span class="o">[</span><span class="ss">:all</span><span class="o">].</span><span class="n">push</span> <span class="s1">&#39;src&#39;</span> <span class="c1"># Attributes</span>
</span><span class="line"><span class="ss">Precious</span><span class="p">:</span><span class="ss">:App</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ss">:wiki_options</span><span class="p">,</span> <span class="p">{</span><span class="ss">:sanitization</span> <span class="o">=&gt;</span> <span class="n">sanitizer</span><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>上段代码的作用是将 script 标签加入白名单，并支持 script 的 src 属性。为什么需要 src 呢，直接在 script 标签里写 JS 代码不行么？</p>

<p>貌似这么直接整确实不行，script 标签里的内容在解析后会被套上一层 <code>CDATA</code> 标记，导致 JS 代码无法执行，不过我没有具体研究 CDATA 是什么时候被加进来的。<strong>改用 src 引入 JS 文件的方式是验证通过的</strong>，这样也能让 MD 文档显得比较干净。</p>

<p>重启 Gollum，用 -&#45;config 指定 config.rb 的路径即可。</p>

<h2 id="section-4">开机启动</h2>

<p>通常步骤就是把在命令行启动的命令写成脚本，<a href="http://www.tanhao.me/talk/1287.html">按照一定方式加入开机启动</a> 就可以了。然而实际当中被<strong>坑惨了</strong>，主要因为我除了 Octopress 就没怎么用过 ruby。问题有二</p>

<ul>
  <li>Mac 自带的 ruby 是 2.0.0 的，也就是 <code>/usr/bin/ruby</code> 指定的那个，rvm 的版本与之并存，可以通过 <code>rvm system</code> 或者 <code>rvm use X.X.X</code> 来切换，按照我的 bash 环境变量配置，Gollum 被安装到 rvm 下的 ruby 中；</li>
  <li>launchctl 的运行环境与 bash 不同，即便 <code>source ~/.bash_profile</code>，或者 <code>rvm use X.X.X</code>，<strong>环境变量里仍然只有系统自带的 ruby</strong>，想用 rvm 的 ruby 就得自己 export PATH。</li>
</ul>

<p>最后，成功配置开机启动的流程如下。</p>

<ul>
  <li><code>rvm system</code>，将 Gollum 安装在系统自带 ruby 里；</li>
  <li>编写 plist 文件</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>开机启动 plist 文件</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="xml"><span class="line"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span class="line"><span class="cp">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span>
</span><span class="line"><span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
</span><span class="line"><span class="nt">&lt;dict&gt;</span>
</span><span class="line">    <span class="nt">&lt;key&gt;</span>Label<span class="nt">&lt;/key&gt;</span>
</span><span class="line">    <span class="nt">&lt;string&gt;</span>com.frank.loginscript<span class="nt">&lt;/string&gt;</span>
</span><span class="line">    <span class="nt">&lt;key&gt;</span>ProgramArguments<span class="nt">&lt;/key&gt;</span>
</span><span class="line">    <span class="nt">&lt;array&gt;</span>
</span><span class="line">        <span class="nt">&lt;string&gt;</span>/Users/frank/Documents/Startup/startup.sh<span class="nt">&lt;/string&gt;</span>
</span><span class="line">    <span class="nt">&lt;/array&gt;</span>
</span><span class="line">    <span class="nt">&lt;key&gt;</span>RunAtLoad<span class="nt">&lt;/key&gt;</span>
</span><span class="line">    <span class="nt">&lt;true/&gt;</span>
</span><span class="line"><span class="nt">&lt;/dict&gt;</span>
</span><span class="line"><span class="nt">&lt;/plist&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<ul>
  <li>创建 /usr/bin/gollum，根据 ruby 的配置加载 Gollum。</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>/usr/bin/gollum</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="c">#!/usr/bin/env ruby_executable_hooks</span>
</span><span class="line"><span class="c">#</span>
</span><span class="line"><span class="c"># This file was generated by RubyGems.</span>
</span><span class="line"><span class="c">#</span>
</span><span class="line"><span class="c"># The application &#39;gollum&#39; is installed as part of a gem, and</span>
</span><span class="line"><span class="c"># this file is here to facilitate running it.</span>
</span><span class="line"><span class="c">#</span>
</span><span class="line">
</span><span class="line">require <span class="s1">&#39;rubygems&#39;</span>
</span><span class="line">
</span><span class="line"><span class="nv">version</span> <span class="o">=</span> <span class="s2">&quot;&gt;= 0&quot;</span>
</span><span class="line">
</span><span class="line"><span class="k">if </span>ARGV.first
</span><span class="line">  <span class="nv">str</span> <span class="o">=</span> ARGV.first
</span><span class="line">  <span class="nv">str</span> <span class="o">=</span> str.dup.force_encoding<span class="o">(</span><span class="s2">&quot;BINARY&quot;</span><span class="o">)</span> <span class="k">if </span>str.respond_to? :force_encoding
</span><span class="line">  <span class="k">if </span><span class="nv">str</span> <span class="o">=</span>~ /<span class="se">\A</span>_<span class="o">(</span>.*<span class="o">)</span>_<span class="se">\z</span>/ and Gem::Version.correct?<span class="o">(</span><span class="nv">$1</span><span class="o">)</span> <span class="k">then</span>
</span><span class="line"><span class="k">    </span><span class="nv">version</span> <span class="o">=</span> <span class="nv">$1</span>
</span><span class="line">    ARGV.shift
</span><span class="line">  end
</span><span class="line">end
</span><span class="line">
</span><span class="line">gem <span class="s1">&#39;gollum&#39;</span>, version
</span><span class="line">load Gem.bin_path<span class="o">(</span><span class="s1">&#39;gollum&#39;</span>, <span class="s1">&#39;gollum&#39;</span>, version<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<ul>
  <li>编写启动脚本，其中 <code>export PATH</code> 是为了指定 <code>ruby_executable_hooks</code> 的路径。查了一下，系统自带的 ruby 没这个可执行文件，虽然这里用的是 rvm ruby 里的，但没问题……如果不加，则会返回错误代码 127，找不到命令。</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>启动脚本</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/Users/frank/.rvm/rubies/ruby-X.X.X/lib/ruby/gems/X.X.X/bin
</span><span class="line">/usr/bin/gollum --allow-upload dir --mathjax --show-all --config /Users/frank/gitlab/wiki-of-taijiru/config.rb --gollum-path /Users/frank/gitlab/wiki-of-taijiru
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><code>/usr/bin/gollum</code> 是为了方便以后全局使用而添加的，能根据我对 ruby 的切换调用相应的 Gollum。其实大可以把启动脚本直接写成</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>启动脚本（2）</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">/Library/Ruby/Gems/X.X.X/gems/gollum/bin/gollum --allow-upload dir --mathjax --show-all --config /Users/frank/gitlab/wiki-of-taijiru/config.rb --gollum-path /Users/frank/gitlab/wiki-of-taijiru
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-5">总结</h2>

<p>本以为很简单的启动配置花了我好长时间，主要是对 ruby 开发环境配置的不熟悉和对 Launch Daemon 的环境变量不了解造成的。这让我想起大一时第一次配置 Apache 的情境，无论怎么修改 index.html，浏览器显示都没有变化。最后终于发现，我修改的是自己通过源码安装的 apache，而每次开关的是系统自带 apache……</p>

<p>不过也正是在查这种傻逼错误的过程里，自己才会去搜索大量资料反复调试，对相关工具的了解也更深。<strong>菜逼的提升，大抵如此吧 ^-^</strong>。</p>

<p class="post-footer">原文地址: <a href="http://frank19900731.github.io/blog/2015/01/02/gollum-kai-ji-qi-dong-pei-zhi/">http://frank19900731.github.io/blog/2015/01/02/gollum-kai-ji-qi-dong-pei-zhi/</a><br /> 作者 <a href="http://frank19900731.github.io">Frank Song</a>&nbsp; 发布于 <a href="http://frank19900731.github.io">http://frank19900731.github.io</a>&nbsp; 转载请注明</p>
]]></content>
  </entry>
  
</feed>
