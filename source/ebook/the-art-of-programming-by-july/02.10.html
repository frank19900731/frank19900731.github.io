<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title></title><link rel="stylesheet" href="style_cache/github-15dc68509b37dbe3792de390aae9bc716c03c421.css" />
  <link rel="stylesheet" href="style_cache/github2-93f8f619dc51fc5d484d938d7ce6ba262a4d736c.css" />
  <style>
    .file-box {
      margin: 64px auto;
      width: 920px;
    }
	body {
		font-size: 14px;
		line-height: 22px;
		<!--font-family: "adelle",Georgia,"Times New Roman",serif;-->
		color: #4e443c;
		background: #f0efe7;
	}

	.book-toc {

	}
	a {
		color: #0388a6;
		text-decoration: none;
	}
	a:hover {
		color: #04b1d8;
		text-decoration: none;
	}
	ol.book-toc li.chapter{
		margin-bottom:0.6em
	}
	ol.book-toc, ol{
		list-style-type: disc
	}
	ol.book-toc{
		margin:30px 36px
	}
	ol.book-toc a{
		padding-left:4px
	}
	li {
		line-height: 22px;
	}
	h1, h2, h3, h4, h5, h6, li, p, a, ol, div{
		margin: 0;
		padding: 0;
		border: 0;
		vertical-align: baseline;
	}
	ul, ol {
		padding: 0;
		margin: 0 0 11px 25px;
	}
	h1 {
		font-size: 36px;
		line-height: 44px;
		margin-bottom: 0.4em;
	}
	h2 {
		font-size: 18px;
		color: #f14e32;
		font-weight: bold;
	}
	h3, h4, h5, h6 {
		font-size: 14px;
		color: #f14e32;
		font-weight: bold;
	}
	ol.book-toc h1{
		font-size: 22px;
		line-height: 44px;
		margin-bottom: 0.4em;
	}
	ol.book-toc h2 {
		font-size: 16px;
		color: #f14e32;
		font-weight: bold;
	}
	ol.book-toc h3, h4, h5, h6 {
		font-size: 14px;
		color: #f14e32;
		font-weight: bold;
	}
	p {
		margin: 0 0 11px;
		font-size: 14px;
		line-height: 22px;
	}
	div {
		display: block;
	}
	div#nav{
		padding: 30px
	}
  </style>
</head>
<body>
  <div class="page">
    <div class="file-box">
	<div class="file">
		<div id="readme" class="blob instapaper_body announce md">
		  <article class="markdown-body entry-content" itemprop="mainContentOfPage">
			<h1>
 <a aria-hidden="true" class="anchor" href="#k%E4%B8%AA%E6%9C%80%E5%B0%8F%E5%92%8C-uva-11997-k-smallest-sums" name="user-content-k%E4%B8%AA%E6%9C%80%E5%B0%8F%E5%92%8C-uva-11997-k-smallest-sums">
  <span class="octicon octicon-link">
  </span>
 </a>
 K个最小和 (UVA 11997 K Smallest Sums)
</h1>
<h3>
 <a aria-hidden="true" class="anchor" href="#%E9%A2%98%E7%9B%AE%E5%A4%A7%E6%84%8F" name="user-content-%E9%A2%98%E7%9B%AE%E5%A4%A7%E6%84%8F">
  <span class="octicon octicon-link">
  </span>
 </a>
 题目大意：
</h3>
<p>
 You're given k arrays, each array has k integers. There are kk ways to pick exactly one element in each array and calculate the sum of the integers. Your task is to find the k smallest sums among them.
</p>
<h4>
 <a aria-hidden="true" class="anchor" href="#input" name="user-content-input">
  <span class="octicon octicon-link">
  </span>
 </a>
 Input
</h4>
<p>
 There will be several test cases. The first line of each case contains an integer k (2&lt;=k&lt;=750). Each of the following k lines contains k positive integers in each array. Each of these integers does not exceed 1,000,000. The input is terminated by end-of-file (EOF). The size of input file does not exceed 5MB.
</p>
<h4>
 <a aria-hidden="true" class="anchor" href="#output" name="user-content-output">
  <span class="octicon octicon-link">
  </span>
 </a>
 Output
</h4>
<p>
 For each test case, print the k smallest sums, in ascending order.
</p>
<h4>
 <a aria-hidden="true" class="anchor" href="#sample-input" name="user-content-sample-input">
  <span class="octicon octicon-link">
  </span>
 </a>
 Sample Input
</h4>
<p>
 3
1 8 5
9 2 5
10 7 6
2
1 1
1 2
</p>
<h4>
 <a aria-hidden="true" class="anchor" href="#output-for-the-sample-input" name="user-content-output-for-the-sample-input">
  <span class="octicon octicon-link">
  </span>
 </a>
 Output for the Sample Input
</h4>
<p>
 9 10 12
2 2
</p>
<p>
 给定一个k*k的一个矩阵，如果让你在每一行取出一个数，再将每一行取出的数相加，那么总共可以得到k^k种相加方法，现在让你求出这k^k个结果中最小的k个结果。
</p>
<h3>
 <a aria-hidden="true" class="anchor" href="#%E5%88%86%E6%9E%90%E4%B8%8E%E8%A7%A3%E6%B3%95" name="user-content-%E5%88%86%E6%9E%90%E4%B8%8E%E8%A7%A3%E6%B3%95">
  <span class="octicon octicon-link">
  </span>
 </a>
 分析与解法
</h3>
<p>
 仔细分析这个题目我们会发现其实这个问题是满足最优子结构的，比如：
</p>
<p>
 如果我们已经计算出了前m行，每行取出一个数相加的最小的k个结果，分别是DP[1],DP[2]...DP
 <a href="%E6%B3%A8%E6%84%8F%E8%BF%99%E9%87%8C%E7%9A%84DP%E8%A1%A8%E7%A4%BA%E7%9A%84%E6%98%AF%E5%89%8Dm%E8%A1%8C%E6%AF%8F%E8%A1%8C%E4%B8%80%E4%B8%AA%E7%9B%B8%E5%8A%A0%E7%9A%84%E6%9C%80%E5%B0%8F%E7%9A%84%E5%89%8Dk%E4%B8%AA%E5%80%BC">
  k
 </a>
</p>
<p>
 假设第m+1行的值是A[1],A[2]...A
 <a href="%E6%B3%A8%E6%84%8F%E8%BF%99%E9%87%8C%E7%9A%84A%5Bi%5D%E8%A1%A8%E7%A4%BA%E7%9A%84%E6%98%AF%E7%AC%ACm+1%E8%A1%8C%E7%9A%84%E7%AC%ACi%E4%B8%AA%E6%95%B0">
  k
 </a>
 当我们推倒到第m+1行时，由于我们只计算了前m行的前k个最小值，那我们是不是有必要多计算一些来推导出第m+1行的前k个最小值呢？
</p>
<p>
 答案是不必要的，我们可以通过以下数学公式严格证明：
设DP[x]是前m行通过计算得出的第x(x&gt;k)小的和，如果上述的假设成立，那么我们可以列出不等式：
</p>
<pre><code>DP[x] + A[y] &lt; DP[m] + A[n] (1)
(DP[m]+A[n]表示只通过DP[1,2...k]计算出的前m+1行第k小的和)
</code></pre>
<p>
 上述不等式的含义是指在第m+1行存在一个数A[y],使得DP[x]+A[y]是前m+1行中前k小的结果。
同时，我们注意到:
</p>
<pre><code>x&gt;k ==&gt; DP[x] &gt; DP[k]  (2)
A[y] &gt;= A[1]           (3)
</code></pre>
<p>
 由上面三个不等式(1),(2),(3)我们可以得到：
</p>
<pre><code>DP[k]+A[1] &lt;= DP[x]+A[y] &lt; DP[m]+A[n]
DP[k]+A[1] &lt; DP[m]+A[n]
</code></pre>
<p>
 之前我们说过DP[m] + A[n] 是前m行第k大的和，然而：比DP[k]+A[1]小的数已经有
</p>
<pre><code>（DP[1]+A[1]）,(DP[2]+A[1])...(DP[k-1]+A[1])共计k-1个，
</code></pre>
<p>
 所以DP[k]+A[1]是第k个最小的和，与假设的DP[m]+A[n]是第k个最小的和相矛盾，所以假设不成立。得证。
</p>
<p>
 通过以上的证明我们可以得出结论要计算第m+1行的前k个最小和是只需要计算出前m行的前k个最小的和即可。这时，我们的目标就转化为了计算一个2*k的数组，在第一行取一个数，在第二行取一个数，得到k^2个和，求他们当中的最小的k个和。
</p>
<p>
 为了计算它，我们把这n^2个数组织成如下n个有序表：
</p>
<pre><code>表1： A1+B1 &lt;= A1+B2&lt;=A1+B3&lt;=......
表2： A2+B1 &lt;= A2+B2&lt;=A2+B3&lt;=......
.
表n： An+B1 &lt;= An+B2&lt;=An+B3&lt;=......
</code></pre>
<p>
 这时我们用一个二元组（sum， b）来保存以上的每一个元素，其中sum=A[a] + B[b].
</p>
<p>
 为什么不保存A的下标a呢？因为我们用不到a的值。如果我们需要在表(sum, b)中赵到下一个元素(sum', b+1)，只要计算sum' = s - B[b] + B[b+1],不需要知道a是多少。
</p>
<h3>
 <a aria-hidden="true" class="anchor" href="#%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81" name="user-content-%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81">
  <span class="octicon octicon-link">
  </span>
 </a>
 实现代码
</h3>
<div class="highlight highlight-c">
 <pre><span class="cp">#include &lt;cstdio&gt;</span>
<span class="cp">#include &lt;algorithm&gt;</span>
<span class="cp">#include &lt;queue&gt;</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">int</span>  <span class="n">a</span><span class="p">[</span><span class="mi">800</span><span class="p">][</span><span class="mi">800</span><span class="p">],</span><span class="n">k</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">node</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">s</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">node</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">)</span> <span class="k">const</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="n">a</span><span class="p">.</span><span class="n">s</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="kt">void</span> <span class="nf">merge</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="kt">int</span> <span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="kt">int</span> <span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">node</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">node</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">s</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tmp</span><span class="p">.</span><span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">tmp</span><span class="p">.</span><span class="n">s</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">n</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">tmp</span><span class="p">.</span><span class="n">s</span><span class="o">=</span><span class="n">tmp</span><span class="p">.</span><span class="n">s</span><span class="o">-</span><span class="n">B</span><span class="p">[</span><span class="n">tmp</span><span class="p">.</span><span class="n">b</span><span class="p">]</span><span class="o">+</span><span class="n">B</span><span class="p">[</span><span class="n">tmp</span><span class="p">.</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
            <span class="n">tmp</span><span class="p">.</span><span class="n">b</span><span class="o">++</span><span class="p">;</span>
            <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">k</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">k</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">k</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
                <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
            <span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">k</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="n">merge</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">k</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">k</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"%d%s"</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="n">i</span><span class="o">!=</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="o">?</span><span class="s">" "</span><span class="o">:</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
</div>
<p>
 参考
 <a href="http://www.cnblogs.com/gj-Acit/p/3583480.html">
  http://www.cnblogs.com/gj-Acit/p/3583480.html
 </a>
</p>
		  </article>
		  
			<div id="nav">
				
					<a href="02.09.html">prev</a>
					|
				
				
					<a href="02.15.html">next</a>
				
				<span style="float: right"><a href="index.html">Back to home</a>
			</div>
		  
		</div>
	</div>
  </div>
  
  <div>&nbsp;</div>
  </div>
  <div style="text-align:center; margin-bottom: 30px">
	  Generated by <a href="https://github.com/marchtea/md_to_github_html">mdtogh</a>
  </div>
</body>
</html>